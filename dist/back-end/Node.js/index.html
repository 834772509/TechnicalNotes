<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Node.js | 杉-技术笔记</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/technicalnotes/img/LOGO.ico">
    <meta name="description" content="记录工作和学习过程中的笔记">
    <link rel="preload" href="/technicalnotes/assets/css/0.styles.6d56aafa.css" as="style"><link rel="preload" href="/technicalnotes/assets/js/app.93acf457.js" as="script"><link rel="preload" href="/technicalnotes/assets/js/2.07677609.js" as="script"><link rel="preload" href="/technicalnotes/assets/js/8.916543f6.js" as="script"><link rel="preload" href="/technicalnotes/assets/js/7.439bcb14.js" as="script"><link rel="prefetch" href="/technicalnotes/assets/js/10.58c987ae.js"><link rel="prefetch" href="/technicalnotes/assets/js/100.78317e2a.js"><link rel="prefetch" href="/technicalnotes/assets/js/101.72735c8b.js"><link rel="prefetch" href="/technicalnotes/assets/js/102.18623a86.js"><link rel="prefetch" href="/technicalnotes/assets/js/103.c5da7261.js"><link rel="prefetch" href="/technicalnotes/assets/js/104.631f92b7.js"><link rel="prefetch" href="/technicalnotes/assets/js/105.3e71fc94.js"><link rel="prefetch" href="/technicalnotes/assets/js/106.7cf89842.js"><link rel="prefetch" href="/technicalnotes/assets/js/11.1bafd68a.js"><link rel="prefetch" href="/technicalnotes/assets/js/12.4d166e6f.js"><link rel="prefetch" href="/technicalnotes/assets/js/13.c7b91b62.js"><link rel="prefetch" href="/technicalnotes/assets/js/14.e99342a0.js"><link rel="prefetch" href="/technicalnotes/assets/js/15.509a0517.js"><link rel="prefetch" href="/technicalnotes/assets/js/16.b150c219.js"><link rel="prefetch" href="/technicalnotes/assets/js/17.c8f4dad2.js"><link rel="prefetch" href="/technicalnotes/assets/js/18.a6c1a53e.js"><link rel="prefetch" href="/technicalnotes/assets/js/19.f2e30560.js"><link rel="prefetch" href="/technicalnotes/assets/js/20.24c131bc.js"><link rel="prefetch" href="/technicalnotes/assets/js/21.cbc8d05a.js"><link rel="prefetch" href="/technicalnotes/assets/js/22.213a45e7.js"><link rel="prefetch" href="/technicalnotes/assets/js/23.43cd4c17.js"><link rel="prefetch" href="/technicalnotes/assets/js/24.0c7689a9.js"><link rel="prefetch" href="/technicalnotes/assets/js/25.69631c28.js"><link rel="prefetch" href="/technicalnotes/assets/js/26.df5d82eb.js"><link rel="prefetch" href="/technicalnotes/assets/js/27.0bfc7d88.js"><link rel="prefetch" href="/technicalnotes/assets/js/28.d5184be5.js"><link rel="prefetch" href="/technicalnotes/assets/js/29.e5043810.js"><link rel="prefetch" href="/technicalnotes/assets/js/3.73f91502.js"><link rel="prefetch" href="/technicalnotes/assets/js/30.46f6d55c.js"><link rel="prefetch" href="/technicalnotes/assets/js/31.c44d598d.js"><link rel="prefetch" href="/technicalnotes/assets/js/32.78315af1.js"><link rel="prefetch" href="/technicalnotes/assets/js/33.9e0c92b8.js"><link rel="prefetch" href="/technicalnotes/assets/js/34.9fea3c84.js"><link rel="prefetch" href="/technicalnotes/assets/js/35.a1f29ae4.js"><link rel="prefetch" href="/technicalnotes/assets/js/36.8dcb9ec2.js"><link rel="prefetch" href="/technicalnotes/assets/js/37.bea2ce6f.js"><link rel="prefetch" href="/technicalnotes/assets/js/38.24ce6e2a.js"><link rel="prefetch" href="/technicalnotes/assets/js/39.d4e09768.js"><link rel="prefetch" href="/technicalnotes/assets/js/4.309cdf91.js"><link rel="prefetch" href="/technicalnotes/assets/js/40.d0952727.js"><link rel="prefetch" href="/technicalnotes/assets/js/41.862e0140.js"><link rel="prefetch" href="/technicalnotes/assets/js/42.110856e0.js"><link rel="prefetch" href="/technicalnotes/assets/js/43.f24cfec6.js"><link rel="prefetch" href="/technicalnotes/assets/js/44.2540f30f.js"><link rel="prefetch" href="/technicalnotes/assets/js/45.5635bc20.js"><link rel="prefetch" href="/technicalnotes/assets/js/46.ea614b91.js"><link rel="prefetch" href="/technicalnotes/assets/js/47.bd2924dc.js"><link rel="prefetch" href="/technicalnotes/assets/js/48.b7f311c9.js"><link rel="prefetch" href="/technicalnotes/assets/js/49.a4b80ff7.js"><link rel="prefetch" href="/technicalnotes/assets/js/5.154d02f2.js"><link rel="prefetch" href="/technicalnotes/assets/js/50.b4419038.js"><link rel="prefetch" href="/technicalnotes/assets/js/51.3dd38211.js"><link rel="prefetch" href="/technicalnotes/assets/js/52.b15f6f76.js"><link rel="prefetch" href="/technicalnotes/assets/js/53.f01cd878.js"><link rel="prefetch" href="/technicalnotes/assets/js/54.0a8dbe91.js"><link rel="prefetch" href="/technicalnotes/assets/js/55.f15e031e.js"><link rel="prefetch" href="/technicalnotes/assets/js/56.9086af25.js"><link rel="prefetch" href="/technicalnotes/assets/js/57.80d86dfb.js"><link rel="prefetch" href="/technicalnotes/assets/js/58.7058ad97.js"><link rel="prefetch" href="/technicalnotes/assets/js/59.bcc32ef3.js"><link rel="prefetch" href="/technicalnotes/assets/js/6.ac4cd4b5.js"><link rel="prefetch" href="/technicalnotes/assets/js/60.b0916753.js"><link rel="prefetch" href="/technicalnotes/assets/js/61.fe5d0491.js"><link rel="prefetch" href="/technicalnotes/assets/js/62.3738e3a6.js"><link rel="prefetch" href="/technicalnotes/assets/js/63.88f7eb01.js"><link rel="prefetch" href="/technicalnotes/assets/js/64.06e6a68d.js"><link rel="prefetch" href="/technicalnotes/assets/js/65.35781f1a.js"><link rel="prefetch" href="/technicalnotes/assets/js/66.c808cfe7.js"><link rel="prefetch" href="/technicalnotes/assets/js/67.f442dffb.js"><link rel="prefetch" href="/technicalnotes/assets/js/68.451fcec9.js"><link rel="prefetch" href="/technicalnotes/assets/js/69.380c2ac7.js"><link rel="prefetch" href="/technicalnotes/assets/js/70.5b54a70f.js"><link rel="prefetch" href="/technicalnotes/assets/js/71.7799b6e7.js"><link rel="prefetch" href="/technicalnotes/assets/js/72.9d98f0d0.js"><link rel="prefetch" href="/technicalnotes/assets/js/73.2b6d55b4.js"><link rel="prefetch" href="/technicalnotes/assets/js/74.626d2522.js"><link rel="prefetch" href="/technicalnotes/assets/js/75.238854e5.js"><link rel="prefetch" href="/technicalnotes/assets/js/76.3e98381e.js"><link rel="prefetch" href="/technicalnotes/assets/js/77.f34570e1.js"><link rel="prefetch" href="/technicalnotes/assets/js/78.d10c29b8.js"><link rel="prefetch" href="/technicalnotes/assets/js/79.68e38126.js"><link rel="prefetch" href="/technicalnotes/assets/js/80.1cd0ff45.js"><link rel="prefetch" href="/technicalnotes/assets/js/81.4ea88f35.js"><link rel="prefetch" href="/technicalnotes/assets/js/82.8d2f17e3.js"><link rel="prefetch" href="/technicalnotes/assets/js/83.041e931c.js"><link rel="prefetch" href="/technicalnotes/assets/js/84.9b15ee18.js"><link rel="prefetch" href="/technicalnotes/assets/js/85.68ea7cc6.js"><link rel="prefetch" href="/technicalnotes/assets/js/86.9cdde003.js"><link rel="prefetch" href="/technicalnotes/assets/js/87.894b8431.js"><link rel="prefetch" href="/technicalnotes/assets/js/88.83e72691.js"><link rel="prefetch" href="/technicalnotes/assets/js/89.fe7fc9a2.js"><link rel="prefetch" href="/technicalnotes/assets/js/9.7be624d5.js"><link rel="prefetch" href="/technicalnotes/assets/js/90.c9f6eea8.js"><link rel="prefetch" href="/technicalnotes/assets/js/91.5723e948.js"><link rel="prefetch" href="/technicalnotes/assets/js/92.9debbb5e.js"><link rel="prefetch" href="/technicalnotes/assets/js/93.9067d7da.js"><link rel="prefetch" href="/technicalnotes/assets/js/94.88dfba2d.js"><link rel="prefetch" href="/technicalnotes/assets/js/95.6998843e.js"><link rel="prefetch" href="/technicalnotes/assets/js/96.50d29511.js"><link rel="prefetch" href="/technicalnotes/assets/js/97.81d92a65.js"><link rel="prefetch" href="/technicalnotes/assets/js/98.ba1c84a0.js"><link rel="prefetch" href="/technicalnotes/assets/js/99.89f80f8e.js">
    <link rel="stylesheet" href="/technicalnotes/assets/css/0.styles.6d56aafa.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><main><main slot="sidebar-top"><!----></main> <div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/technicalnotes/" class="home-link router-link-active"><!----> <span class="site-name">杉-技术笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/technicalnotes/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Web 开发
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technicalnotes/front-end/HTML5/" class="nav-link">
  HTML5
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/front-end/CSS3/" class="nav-link">
  CSS3
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/front-end/JavaScript/" class="nav-link">
  JavaScript
</a></li></ul></li><li class="dropdown-item"><h4>
          前端框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technicalnotes/front-end/Vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/front-end/React/" class="nav-link">
  React
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/front-end/WechatApplet/" class="nav-link">
  微信小程序
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/front-end/Electron/" class="nav-link">
  Electron
</a></li></ul></li><li class="dropdown-item"><h4>
          移动端开发
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technicalnotes/front-end/Andorid/" class="nav-link">
  Andorid
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/front-end/Flutter/" class="nav-link">
  Flutter
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Java
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technicalnotes/back-end/Java/" class="nav-link">
  Java 基础
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/back-end/Java/JavaWeb/" class="nav-link">
  JavaWeb
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/back-end/Java/Mybatis/" class="nav-link">
  Mybatis
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/back-end/Java/Spring/" class="nav-link">
  Spring
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/back-end/Java/SpringMVC/" class="nav-link">
  SpringMVC
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/back-end/Java/SpringBoot/" class="nav-link">
  SpringBoot
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/back-end/Java/JVM/" class="nav-link">
  JVM
</a></li></ul></li><li class="dropdown-item"><h4>
          Rust
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technicalnotes/back-end/Rust/" class="nav-link">
  Rust 基础
</a></li></ul></li><li class="dropdown-item"><h4>
          Node.js
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technicalnotes/back-end/Node.js/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Node.js
</a></li></ul></li><li class="dropdown-item"><h4>
          Python
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technicalnotes/back-end/Python/" class="nav-link">
  Python 基础
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/back-end/Python/Django/" class="nav-link">
  Django
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/back-end/Python/Flask/" class="nav-link">
  Flask
</a></li></ul></li><li class="dropdown-item"><h4>
          数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technicalnotes/back-end/DataBase/MySQL/" class="nav-link">
  MySQL
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/back-end/DataBase/Oracle/" class="nav-link">
  Oracle
</a></li></ul></li><li class="dropdown-item"><h4>
          PHP
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technicalnotes/back-end/PHP/" class="nav-link">
  PHP 基础
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/back-end/PHP/ThinkPHP/" class="nav-link">
  ThinkPHP
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/technicalnotes/Other/Photoshop/" class="nav-link">
  Photoshop
</a></li><li class="dropdown-item"><!----> <a href="/technicalnotes/Other/Unity/" class="nav-link">
  Unity
</a></li><li class="dropdown-item"><!----> <a href="/technicalnotes/Other/Git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/technicalnotes/Other/WinPE/" class="nav-link">
  WinPE
</a></li></ul></div></div><div class="nav-item"><a href="https://firpe.cn/about" target="_blank" rel="noopener noreferrer" class="nav-link external">
  关于
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://firpe.cn/donate" target="_blank" rel="noopener noreferrer" class="nav-link external">
  投食 
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/technicalnotes/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Web 开发
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technicalnotes/front-end/HTML5/" class="nav-link">
  HTML5
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/front-end/CSS3/" class="nav-link">
  CSS3
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/front-end/JavaScript/" class="nav-link">
  JavaScript
</a></li></ul></li><li class="dropdown-item"><h4>
          前端框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technicalnotes/front-end/Vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/front-end/React/" class="nav-link">
  React
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/front-end/WechatApplet/" class="nav-link">
  微信小程序
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/front-end/Electron/" class="nav-link">
  Electron
</a></li></ul></li><li class="dropdown-item"><h4>
          移动端开发
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technicalnotes/front-end/Andorid/" class="nav-link">
  Andorid
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/front-end/Flutter/" class="nav-link">
  Flutter
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Java
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technicalnotes/back-end/Java/" class="nav-link">
  Java 基础
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/back-end/Java/JavaWeb/" class="nav-link">
  JavaWeb
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/back-end/Java/Mybatis/" class="nav-link">
  Mybatis
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/back-end/Java/Spring/" class="nav-link">
  Spring
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/back-end/Java/SpringMVC/" class="nav-link">
  SpringMVC
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/back-end/Java/SpringBoot/" class="nav-link">
  SpringBoot
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/back-end/Java/JVM/" class="nav-link">
  JVM
</a></li></ul></li><li class="dropdown-item"><h4>
          Rust
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technicalnotes/back-end/Rust/" class="nav-link">
  Rust 基础
</a></li></ul></li><li class="dropdown-item"><h4>
          Node.js
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technicalnotes/back-end/Node.js/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Node.js
</a></li></ul></li><li class="dropdown-item"><h4>
          Python
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technicalnotes/back-end/Python/" class="nav-link">
  Python 基础
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/back-end/Python/Django/" class="nav-link">
  Django
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/back-end/Python/Flask/" class="nav-link">
  Flask
</a></li></ul></li><li class="dropdown-item"><h4>
          数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technicalnotes/back-end/DataBase/MySQL/" class="nav-link">
  MySQL
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/back-end/DataBase/Oracle/" class="nav-link">
  Oracle
</a></li></ul></li><li class="dropdown-item"><h4>
          PHP
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technicalnotes/back-end/PHP/" class="nav-link">
  PHP 基础
</a></li><li class="dropdown-subitem"><a href="/technicalnotes/back-end/PHP/ThinkPHP/" class="nav-link">
  ThinkPHP
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/technicalnotes/Other/Photoshop/" class="nav-link">
  Photoshop
</a></li><li class="dropdown-item"><!----> <a href="/technicalnotes/Other/Unity/" class="nav-link">
  Unity
</a></li><li class="dropdown-item"><!----> <a href="/technicalnotes/Other/Git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/technicalnotes/Other/WinPE/" class="nav-link">
  WinPE
</a></li></ul></div></div><div class="nav-item"><a href="https://firpe.cn/about" target="_blank" rel="noopener noreferrer" class="nav-link external">
  关于
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://firpe.cn/donate" target="_blank" rel="noopener noreferrer" class="nav-link external">
  投食 
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Node.js</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/technicalnotes/back-end/Node.js/" aria-current="page" class="active sidebar-link">Node.js</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#基本概念" class="sidebar-link">基本概念</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#浏览器内核" class="sidebar-link">浏览器内核</a></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#渲染引擎工作过程" class="sidebar-link">渲染引擎工作过程</a></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#javascript-引擎" class="sidebar-link">JavaScript 引擎</a></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#webkit-内核" class="sidebar-link">WebKit 内核</a></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#v8-引擎" class="sidebar-link">V8 引擎</a></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#v8-引擎的原理" class="sidebar-link">V8 引擎的原理</a></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#repl" class="sidebar-link">REPL</a></li></ul></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#环境搭建" class="sidebar-link">环境搭建</a></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#node-程序传递参数" class="sidebar-link">Node 程序传递参数</a></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#常见的全局对象" class="sidebar-link">常见的全局对象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#特殊的全局对象" class="sidebar-link">特殊的全局对象</a></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#常见的全局对象-2" class="sidebar-link">常见的全局对象</a></li></ul></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#模块化" class="sidebar-link">模块化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#commonjs" class="sidebar-link">CommonJS</a></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#require-细节" class="sidebar-link">require 细节</a></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#模块的加载过程" class="sidebar-link">模块的加载过程</a></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#amd-规范（了解）" class="sidebar-link">AMD 规范（了解）</a></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#cmd-规范" class="sidebar-link">CMD 规范</a></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#es-module" class="sidebar-link">ES Module</a></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#es-module-加载过程" class="sidebar-link">ES Module 加载过程</a></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#commonjs-和-es-module-交互" class="sidebar-link">CommonJS 和 ES Module 交互</a></li></ul></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#内置模块-path" class="sidebar-link">内置模块 Path</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#基本方法" class="sidebar-link">基本方法</a></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#拼接路径" class="sidebar-link">拼接路径</a></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#文件描述符" class="sidebar-link">文件描述符</a></li></ul></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#内置模块-fs" class="sidebar-link">内置模块 fs</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#大多数-api-都提供三种操作方式：" class="sidebar-link">大多数 API 都提供三种操作方式：</a></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#文件的读写" class="sidebar-link">文件的读写</a></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#文件夹操作" class="sidebar-link">文件夹操作</a></li></ul></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#内置模块-events" class="sidebar-link">内置模块 events</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#基本使用" class="sidebar-link">基本使用</a></li><li class="sidebar-sub-header"><a href="/technicalnotes/back-end/Node.js/#常见的属性" class="sidebar-link">常见的属性</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="node-js"><a href="#node-js" class="header-anchor">#</a> Node.js</h1> <p><a href="http://nodejs.cn/api/" target="_blank" rel="noopener noreferrer">Node.js 中文文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="基本概念"><a href="#基本概念" class="header-anchor">#</a> 基本概念</h2> <h3 id="浏览器内核"><a href="#浏览器内核" class="header-anchor">#</a> 浏览器内核</h3> <ul><li>Gecko：早期被 Netscape 和 Mozilla Firefox 浏览器使用;</li> <li>Webkit：苹果基于 KHTML 开发、开源的，用于 Safari，Google Chrome 之前也在使用;</li> <li>Trident：微软开发，被 IE4~IE11 浏览器使用，但是 Edge 浏览器已经转向 Blink</li> <li>Blink：是 Webkit 的一个分支，Google 开发，目前应用于 Google Chrome、Edge、Opera 等;</li></ul> <p>事实上，我们经常说的浏览器内核指的是浏览器的排版引擎：</p> <ul><li>排版引擎（layout engine），也称为浏览器引擎（browser engine）、页面渲染引擎（rendering engine）或样版引擎。</li></ul> <h3 id="渲染引擎工作过程"><a href="#渲染引擎工作过程" class="header-anchor">#</a> 渲染引擎工作过程</h3> <p><img src="/technicalnotes/assets/img/渲染引擎工作过程.0268d512.jpg" alt="渲染引擎工作过程"></p> <h3 id="javascript-引擎"><a href="#javascript-引擎" class="header-anchor">#</a> JavaScript 引擎</h3> <ul><li>为什么需要 JavaScript 引擎呢？
<ul><li>事实上我们编写的 JavaScript 无论你交给浏览器或者 Node 执行，最后都是需要被 CPU 执行的；</li> <li>但是 CPU 只认识自己的指令集，实际上是机器语言，才能被 CPU 所执行；</li> <li>所以我们需要 JavaScript 引擎帮助我们将 JavaScript 代码翻译成 CPU 指令来执行；</li></ul></li> <li>比较常见的 JavaScript 引擎有哪些呢？
<ul><li>SpiderMonkey：第一款 JavaScript 引擎，由 Brenda- Eich 开发（也就是 JavaScript 作者）；</li> <li>Chakra：微软开发，用于 IE 浏览器；</li> <li>JavaScriptCore：WebKit 中的 JavaScript 引擎，Apple 公司开发；</li> <li>V8：Google 开发的强大 JavaScript 引擎，也帮助 Chrome 从众多浏览器中脱颖而出；</li></ul></li></ul> <h3 id="webkit-内核"><a href="#webkit-内核" class="header-anchor">#</a> WebKit 内核</h3> <p>这里我们先以 WebKit 为例，WebKit 事实上由两部分组成的：</p> <ul><li>WebCore：负责 HTML 解析、布局、渲染等等相关的工作；</li> <li>JavaScriptCore：解析、执行 JavaScript 代码；</li></ul> <h3 id="v8-引擎"><a href="#v8-引擎" class="header-anchor">#</a> V8 引擎</h3> <p>V8 是用 C ++编写的 Google 开源高性能 JavaScript 和 WebAssembly 引擎，它用于 Chrome 和 Node.js 等。</p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>v8 是一个名字，并不是版本号</p></div> <ul><li>它实现 ECMAScript 和 WebAssembly，并在 Windows 7 或更高版本，macOS 10.12+和使用 x64，IA-32，
ARM 或 MIPS 处理器的 Linux 系统上运行。</li> <li>V8 可以独立运行，也可以嵌入到任何 C ++应用程序中。</li></ul> <p><img src="/technicalnotes/assets/img/V8引擎.d727b940.jpg" alt="V8引擎"></p> <h3 id="v8-引擎的原理"><a href="#v8-引擎的原理" class="header-anchor">#</a> V8 引擎的原理</h3> <ul><li>V8 引擎本身的源码非常复杂，大概有超过 100w 行 C++代码，但是我们可以简单了解一下它执行 JavaScript 代码的原理：</li> <li>Parse 模块会将 JavaScript 代码转换成 AST（抽象语法树），这是因为解释器并不直接认识 JavaScript 代码；
<ul><li>如果函数没有被调用，那么是不会被转换成 AST 的；</li> <li>Parse 的 V8 官方文档：https://v8.dev/blog/scanner</li></ul></li> <li>Ignition 是一个解释器，会将 AST 转换成 ByteCode（字节码）
<ul><li>同时会收集 TurboFan 优化所需要的信息（比如函数参数的类型信息，有了类型才能进行真实的运算）；</li> <li>如果函数只调用一次，Ignition 会执行解释执行 ByteCode；</li> <li>Ignition 的 V8 官方文档：https://v8.dev/blog/ignition-interpreter</li></ul></li> <li>TurboFan 是一个编译器，可以将字节码编译为 CPU 可以直接执行的机器码；
<ul><li>如果一个函数被多次调用，那么就会被标记为热点函数，那么就会经过 TurboFan 转换成优化的机器码，提高代码的执行性能；</li> <li>但是，机器码实际上也会被还原为 ByteCode，这是因为如果后续执行函数的过程中，类型发生了变化（比如 sum 函数原来执行的是 number 类型，后
来执行变成了 string 类型），之前优化的机器码并不能正确的处理运算，就会逆向的转换成字节码；</li> <li>TurboFan 的 V8 官方文档：https://v8.dev/blog/turbofan-jit</li></ul></li> <li>上面是 JavaScript 代码的执行过程，事实上 V8 的内存回收也是其强大的另外一个原因，不过这里暂时先不展开讨论：
<ul><li>Orinoco 模块，负责垃圾回收，将程序中不需要的内存回收；</li> <li>Orinoco 的 V8 官方文档：https://v8.dev/blog/trash-talk</li></ul></li></ul> <h3 id="repl"><a href="#repl" class="header-anchor">#</a> REPL</h3> <p>REPL 是 Read-Eval-Print Loop 的简称，翻译为“读取-求值-输出”循环；</p> <ul><li>REPL 是一个简单的、交互式的编程环境；</li> <li>事实上，我们浏览器的 console 就可以看成一个 REPL。</li> <li>Node 也给我们提供了一个 REPL 环境，我们可以在其中演练简单的代码。</li></ul> <h2 id="环境搭建"><a href="#环境搭建" class="header-anchor">#</a> 环境搭建</h2> <p><a href="https://nodejs.org/zh-cn/" target="_blank" rel="noopener noreferrer">下载 Node.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>LTS 版本：相对稳定一些，推荐线上环境使用该版本；
Current 版本：最新的 Node 版本，包含很多新特性；</p> <h2 id="node-程序传递参数"><a href="#node-程序传递参数" class="header-anchor">#</a> Node 程序传递参数</h2> <p><code>process.argv</code>中，第一个元素为 Node 路径，第二个元素为当前程序路径</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token punctuation">;</span>
process<span class="token punctuation">.</span>argv<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="常见的全局对象"><a href="#常见的全局对象" class="header-anchor">#</a> 常见的全局对象</h2> <p>Node 中给我们提供了一些全局对象，方便我们进行一些操作</p> <h3 id="特殊的全局对象"><a href="#特殊的全局对象" class="header-anchor">#</a> 特殊的全局对象</h3> <p>这些全局对象实际上是模块中的变量，只是每个模块都有，看来像是全局变量，在命令行交互中是不可以使用的。</p> <ul><li><p>当前目录</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>当前文件路径</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>__filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h3 id="常见的全局对象-2"><a href="#常见的全局对象-2" class="header-anchor">#</a> 常见的全局对象</h3> <ul><li><p>process</p> <p>Node 进程相关信息（Node 的运行环境、参数信息等）</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>process<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>console 对象</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token comment">// 打印输出</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 清空控制台</span>
console<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 打印函数的调用栈</span>
console<span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>定时器函数</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;setTimeout&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;setInterval&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setImmediate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;setImmediate&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;process.nextTick&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>global 对象</p> <p>global 是一个全局对象，process、console、setTimeout 等都有被放到 global 中：</p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>在 node 中，我们通过 var 定义一个变量，它只是在当前模块中有一个变量，不会放到全局中</p></div> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>global<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h2 id="模块化"><a href="#模块化" class="header-anchor">#</a> 模块化</h2> <h3 id="commonjs"><a href="#commonjs" class="header-anchor">#</a> CommonJS</h3> <p>CommonJS 是<strong>一个规范</strong>，最初提出来是在浏览器以外的地方使用，并且当时被命名为 <strong>ServerJS</strong>，后来为了体现它的广泛性，修改为 <strong>CommonJS</strong>，平时我们也会简称为 <strong>CJS</strong>。</p> <ul><li>Node 是 CommonJS 在服务器端一个具有代表性的实现；</li> <li>Browserify 是 CommonJS 在浏览器中的一种实现；</li> <li>webpack 打包工具具备对 CommonJS 的支持和转换；</li></ul> <p>Node 中对 CommonJS 进行了支持和实现，让我们在开发 node 的过程中可以方便的进行模块化开发：</p> <ul><li>在 Node 中每一个 js 文件都是一个单独的模块；</li> <li>这个模块中包括 CommonJS 规范的核心变量：exports、module.exports、require；</li> <li>我们可以使用这些变量来方便的进行模块化开发；</li></ul> <p>前面我们提到过模块化的核心是导出和导入，Node 中对其进行了实现：</p> <ul><li>exports 和 module.exports 可以负责对模块中的内容进行导出；</li> <li>require 函数可以帮助我们导入其他模块（自定义模块、系统模块、第三方库模块）中的内容；</li></ul> <p>\模块名.js</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> 变量名 <span class="token operator">=</span> 值<span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">函数名</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token comment">// module.exports 方式导出</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  变量名<span class="token punctuation">,</span>
  函数名<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// exports 直接导出</span>
exports<span class="token punctuation">.</span>变量名 <span class="token operator">=</span> 变量名<span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>函数名 <span class="token operator">=</span> 函数名<span class="token punctuation">;</span>
</code></pre></div><p>\index.js</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> 变量名<span class="token punctuation">,</span> 函数名 <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./模块名&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>变量名<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">函数名</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="require-细节"><a href="#require-细节" class="header-anchor">#</a> require 细节</h3> <p>require 是一个函数，可以帮助我们引入一个文件（模块）中导入的对象。</p> <div class="language-JavaScri-t extra-class"><pre class="language-text"><code>require(X);
</code></pre></div><p>查找规则：</p> <ol><li>核心模块，比如 -ath、htt-。直接返回核心模块，并且停止查找</li> <li>以 ./ 或 ../ 或 /（根目录）开头的。
<ul><li>第一步：将 X 当做一个文件在对应的目录下查找；
<ul><li>如果有后缀名，按照后缀名的格式查找对应的文件</li> <li>如果没有后缀名，会按照如下顺序：
<ol><li>直接查找文件 X</li> <li>查找 X.js 文件</li> <li>查找 X.json 文件</li> <li>查找 X.node 文件</li></ol></li></ul></li> <li>第二步：没有找到对应的文件，将 X 作为一个目录
<ul><li>查找目录下面的 index 文件
<ol><li>查找 X/index.js 文件</li> <li>查找 X/index.json 文件</li> <li>查找 X/index.node 文件</li></ol></li></ul></li> <li>如果没有找到，那么报错：not found</li></ul></li> <li>直接是一个 X（没有路径），并且 X 不是一个核心模块
从当前目录开始，查找所有目录下的<code>node_modules</code>目录</li></ol> <h3 id="模块的加载过程"><a href="#模块的加载过程" class="header-anchor">#</a> 模块的加载过程</h3> <ol><li>模块在被第一次引入时，模块中的 JavaScri-t 代码会被运行一次</li> <li>模块被多次引入时，会缓存，最终只加载（运行）一次
<ul><li>每个模块对象 module 都有一个属性：loaded。</li> <li>false 表示还没有加载，为 true 表示已经加载；</li></ul></li> <li>如果有循环引入，那么加载顺序是一种图结构
<ul><li>图结构在遍历的过程中，有深度优先搜索（DFS, de-th first search）和广度优先搜索（BFS, breadth first search）；</li> <li>Node 采用的是深度优先算法</li></ul></li></ol> <h3 id="amd-规范（了解）"><a href="#amd-规范（了解）" class="header-anchor">#</a> AMD 规范（了解）</h3> <p>AMD 主要是应用于浏览器的一种模块化规范：</p> <ul><li>AMD 是 Asynchronous Module Definition（异步模块定义）的缩写；</li> <li>它采用的是异步加载模块；</li> <li>事实上 AMD 的规范还要早于 CommonJS，但是 CommonJS 目前依然在被使用，而 AMD 使用的较少了；</li></ul> <h3 id="cmd-规范"><a href="#cmd-规范" class="header-anchor">#</a> CMD 规范</h3> <p>CMD 规范也是应用于浏览器的一种模块化规范：</p> <ul><li>CMD 是 Common Module Definition（通用模块定义）的缩写；</li> <li>它也采用了异步加载模块，但是它将 CommonJS 的优点吸收了过来；</li> <li>但是目前 CMD 使用也非常少了；</li> <li>CMD 也有自己比较优秀的实现方案：<a href="https://github.com/seajs/seajs" target="_blank" rel="noopener noreferrer">SeaJS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="es-module"><a href="#es-module" class="header-anchor">#</a> ES Module</h3> <p>ES Module 模块采用 export 和 import 关键字来实现模块化：</p> <ul><li>export 负责将模块内的内容导出；</li> <li>import 负责从其他模块导入内容；</li></ul> <p>ES Module 和 CommonJS 的模块化有一些不同之处：</p> <ul><li><p>一方面它使用了 import 和 export 关键字；</p></li> <li><p>另一方面它采用编译期的静态分析，并且也加入了动态引用的方式；</p></li> <li><p>index.html</p></li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>./index.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>/modules/模块名.js</li></ul> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p><code>export{}</code>中的<code>{}</code>不是对象，里面放置要导出的变量引用列表。</p></div> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> 变量名 <span class="token operator">=</span> 值<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">函数名</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 导出方式1</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> 变量名 <span class="token operator">=</span> 值<span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">函数名</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 导出方式2（常用）</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span>
  变量名<span class="token punctuation">,</span>
  函数名<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 导出方式3，起别名</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span>
  变量名 <span class="token keyword">as</span> 别名<span class="token punctuation">,</span>
  函数名 <span class="token keyword">as</span> 别名<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>index.js</li></ul> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token comment">// 导入方式1</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> 变量名<span class="token punctuation">,</span> 函数名 <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./modules/模块名.js&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>变量名<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 方式2：导出变量后起别名</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> 变量名 <span class="token keyword">as</span> 别名<span class="token punctuation">,</span> 函数名 <span class="token keyword">as</span> 别名 <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./modules/模块名.js&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>别名<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 方式3：* as 别名</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> 别名 <span class="token keyword">from</span> <span class="token string">&quot;./modules/模块名.js&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>别名<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><p>Export 和 Import 结合使用</p> <p>在开发和封装一个功能库时，通常我们希望将暴露的所有接口放到一个文件中；</p> <ul><li>这样方便指定统一的接口规范，也方便阅读；</li> <li>这个时候，我们就可以使用 export 和 import 结合使用；</li></ul> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token punctuation">{</span> 变量名<span class="token punctuation">,</span> 函数名 <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./modules/模块名.js&quot;</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>default 用法</p> <p>默认导出（default export）</p> <ul><li>默认导出 export 时可以不需要指定名字；</li> <li>在导入时不需要使用 {}，并且可以自己来指定名字；</li> <li>它也方便我们和现有的 CommonJS 等规范相互操作；</li></ul> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>在一个模块中，只能有一个默认导出（default export）</p></div> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token comment">// 默认导出函数</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">函数名</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token comment">// 默认导出变量</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> 变量名<span class="token punctuation">;</span>
</code></pre></div><div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> 函数名 <span class="token keyword">from</span> <span class="token string">&quot;./modules/模块名.js&quot;</span><span class="token punctuation">;</span>
<span class="token function">函数名</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h3 id="es-module-加载过程"><a href="#es-module-加载过程" class="header-anchor">#</a> ES Module 加载过程</h3> <p>ES Module 加载 js 文件的过程是编译（解析）时加载的，并且是异步的：</p> <ul><li>编译时（解析）时加载，意味着 import 不能和运行时相关的内容放在一起使用：</li> <li>比如 from 后面的路径需要动态获取；</li> <li>比如不能将 import 放到 if 等语句的代码块中；</li> <li>所以我们有时候也称 ES Module 是静态解析的，而不是动态或者运行时解析的；</li></ul> <p>异步的意味着：JS 引擎在遇到 import 时会去获取这个 js 文件，但是这个获取的过程是异步的，并不会阻塞主线程继续执行；</p> <ul><li>也就是说设置了 type=module 的代码，相当于在 script 标签上也加上了 async 属性；</li> <li>如果我们后面有普通的 script 标签以及对应的代码，那么 ES Module 对应的 js 文件和代码不会阻塞它们的执行；</li></ul> <h3 id="commonjs-和-es-module-交互"><a href="#commonjs-和-es-module-交互" class="header-anchor">#</a> CommonJS 和 ES Module 交互</h3> <ul><li>结论一：通常情况下，CommonJS 不能加载 ES Module
<ul><li>因为 CommonJS 是同步加载的，但是 ES Module 必须经过静态分析等，无法在这个时候执行 JavaScript 代码；</li> <li>但是这个并非绝对的，某些平台在实现的时候可以对代码进行针对性的解析，也可能会支持；</li> <li>Node 当中是不支持的；</li></ul></li> <li>结论二：多数情况下，ES Module 可以加载 CommonJS
<ul><li>ES Module 在加载 CommonJS 时，会将其 module.exports 导出的内容作为 default 导出方式来使用；</li> <li>这个依然需要看具体的实现，比如 webpack 中是支持的、Node 最新的 Current 版本也是支持的；</li> <li>但是在最新的 LTS 版本中就不支持；</li></ul></li></ul> <h2 id="内置模块-path"><a href="#内置模块-path" class="header-anchor">#</a> 内置模块 Path</h2> <h3 id="基本方法"><a href="#基本方法" class="header-anchor">#</a> 基本方法</h3> <ul><li><p>取文件路径</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>path<span class="token punctuation">.</span><span class="token function">dirname</span><span class="token punctuation">(</span><span class="token string">&quot;路径&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>取文件名（含后缀）</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>path<span class="token punctuation">.</span><span class="token function">basename</span><span class="token punctuation">(</span><span class="token string">&quot;路径&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>取文件后缀（带.）</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>path<span class="token punctuation">.</span><span class="token function">extname</span><span class="token punctuation">(</span><span class="token string">&quot;路径&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h3 id="拼接路径"><a href="#拼接路径" class="header-anchor">#</a> 拼接路径</h3> <ul><li><p>resolve 方法</p> <p>resolve 会判断拼接的路径字符串中，是否有以<code>/</code>或<code>./</code>或<code>../</code>开头的路径。如果有表示是一个绝对路径，会返回对应的拼接路径，如果没有，那么会和当前执行文件所在的文件夹进行路径的拼接。</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> filePath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&quot;路径&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;文件名&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>join 方法</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;路径&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;文件名&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h3 id="文件描述符"><a href="#文件描述符" class="header-anchor">#</a> 文件描述符</h3> <p>文件描述符（File descriptors）：</p> <ul><li>在 POSIX 系统上，对于每个进程，内核都维护着一张当前打开着的文件和资源的表格。</li> <li>每个打开的文件都分配了一个称为文件描述符的简单的数字标识符。</li> <li>在系统层，所有文件系统操作都使用这些文件描述符来标识和跟踪每个特定的文件。</li> <li>Windows 系统使用了一个虽然不同但概念上类似的机制来跟踪资源。</li></ul> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

fs<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;文件路径&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> fd</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  fs<span class="token punctuation">.</span><span class="token function">fstat</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="内置模块-fs"><a href="#内置模块-fs" class="header-anchor">#</a> 内置模块 fs</h2> <p>fs (File System)，文件系统。对于任何一个为服务器端服务的语言或者框架通常都会有自己的文件系统：</p> <ul><li>因为服务器需要将各种数据、文件等放置到不同的地方；</li> <li>比如用户数据可能大多数是放到数据库中；</li> <li>比如某些配置文件或者用户资源（图片、音视频）都是以文件的形式存在于操作系统上的；</li></ul> <h3 id="大多数-api-都提供三种操作方式："><a href="#大多数-api-都提供三种操作方式：" class="header-anchor">#</a> 大多数 API 都提供三种操作方式：</h3> <ul><li>方式一：同步操作文件：代码会被阻塞，不会继续执行；</li></ul> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> info <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">statSync</span><span class="token punctuation">(</span><span class="token string">&quot;文件路径&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>方式二：异步回调函数操作文件：代码不会被阻塞，需要传入回调函数，当获取到结果时，回调函数被执行；</li></ul> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

fs<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span><span class="token string">&quot;文件路径&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stat</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stat<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>方式三：异步 Promise 操作文件：代码不会被阻塞，通过 fs.promises 调用方法操作，会返回一个 Promise，可以通过 then、catch 进行处理；</li></ul> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>fs<span class="token punctuation">.</span>promises<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span><span class="token string">&quot;文件路径&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">info</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="文件的读写"><a href="#文件的读写" class="header-anchor">#</a> 文件的读写</h3> <ul><li>写文件</li></ul> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token string">&quot;文件路径&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;文件内容&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> flag<span class="token operator">:</span> <span class="token string">&quot;flag选项&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>flag 选项：</p> <ul><li><p>w : 打开文件写入，默认值；</p></li> <li><p>w+ : 打开文件进行读写，如果不存在则创建文件；</p></li> <li><p>r+ : 打开文件进行读写，如果不存在那么抛出异常；</p></li> <li><p>r : 打开文件读取，读取时的默认值；</p></li> <li><p>a : 打开要写入的文件，将流放在文件末尾。如果不存在则创建文件；</p></li> <li><p>a+ : 打开文件以进行读写，将流放在文件末尾。如果不存在则创建文件</p></li> <li><p>读文件</p></li></ul> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>如果不填写 encoding，返回的结果是 Buffer</p></div> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">&quot;文件路径&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>encoding<span class="token operator">:</span> <span class="token string">&quot;utf8&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="文件夹操作"><a href="#文件夹操作" class="header-anchor">#</a> 文件夹操作</h3> <ul><li>判断是否为文件夹</li></ul> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

fs<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span><span class="token string">&quot;文件夹路径&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stat</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stat<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>判断文件夹是否存在</li></ul> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

fs<span class="token punctuation">.</span><span class="token function">existsSync</span><span class="token punctuation">(</span><span class="token string">&quot;文件夹路径&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>创建文件夹</li></ul> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

fs<span class="token punctuation">.</span><span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token string">&quot;文件夹路径&quot;</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>读取文件夹中的所有文件</li></ul> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

fs<span class="token punctuation">.</span><span class="token function">readdir</span><span class="token punctuation">(</span><span class="token string">&quot;文件夹路径&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>files</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>files<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token comment">/**
 * 枚举文件夹内的所有文件，包括子目录
 * @param {String} dirname 文件夹路径
 */</span>
<span class="token keyword">function</span> <span class="token function">getFiles</span><span class="token punctuation">(</span><span class="token parameter">dirname</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  fs<span class="token punctuation">.</span><span class="token function">readdir</span><span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> <span class="token punctuation">{</span> withFileTypes<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> files</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    files<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> filePath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">getFiles</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>重命名文件夹</li></ul> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

fs<span class="token punctuation">.</span><span class="token function">rename</span><span class="token punctuation">(</span><span class="token string">&quot;文件夹路径&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;新路径&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="内置模块-events"><a href="#内置模块-events" class="header-anchor">#</a> 内置模块 events</h2> <p>Node 中的核心 API 都是基于异步事件驱动的：</p> <ul><li>在这个体系中，某些对象（发射器（Emitters））发出某一个事件；</li> <li>我们可以监听这个事件（监听器 Listeners），并且传入的回调函数，这个回调函数会在监听到事件时调用；</li></ul> <h3 id="基本使用"><a href="#基本使用" class="header-anchor">#</a> 基本使用</h3> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> EventEmitter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;events&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建发射器</span>
<span class="token keyword">const</span> emitter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventEmitter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 监听事件</span>
emitter<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;事件名&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">参数</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;监听到事件&quot;</span><span class="token punctuation">,</span> 参数<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">事件名</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">参数</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;监听到事件&quot;</span><span class="token punctuation">,</span> 参数<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
emitter<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;事件名&quot;</span><span class="token punctuation">,</span> 事件名<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 发射事件</span>
emitter<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&quot;事件名&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;参数值&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 关闭事件</span>
emitter<span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span><span class="token string">&quot;事件名&quot;</span><span class="token punctuation">,</span> 事件名<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="常见的属性"><a href="#常见的属性" class="header-anchor">#</a> 常见的属性</h3> <ul><li><p>获取 EventEmitter 对象注册的事件</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>emitter<span class="token punctuation">.</span><span class="token function">eventNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>获取 EventEmitter 对象某一个事件名称中监听器的个数</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>emitter<span class="token punctuation">.</span><span class="token function">listenerCount</span><span class="token punctuation">(</span><span class="token string">&quot;事件名&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>获取 EventEmitter 对象某个事件监听器上所有的监听器</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>emitter<span class="token punctuation">.</span><span class="token function">listeners</span><span class="token punctuation">(</span><span class="token string">&quot;事件名&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新:</span> <span class="time">2020/10/19 上午10:13:30</span></div></footer> <!----> </main></div> <div class="footer" data-v-c54358c4><div id="footer-info" data-v-c54358c4><div class="footer-left" data-v-c54358c4>
      © 2020
      <!----></div> <div class="footer-right" data-v-c54358c4>Theme:<a href="https://github.com/JoeyBling/vuepress-theme-yilia-plus" target="_blank">vuepress-theme-yilia-plus</a> by Litten</div></div> <div class="busuanzi" data-v-c54358c4><span id="busuanzi_container_site_pv" style="display:none">
    本站总访问量
    <span id="busuanzi_value_site_pv"></span>次
    <span class="post-meta-divider">|</span></span> <span id="busuanzi_container_site_uv" style="display:none">
    本站访客数
    <span id="busuanzi_value_site_uv"></span>人
  </span></div></div></main><div class="global-ui"><!----><!----></div></div>
    <script src="/technicalnotes/assets/js/app.93acf457.js" defer></script><script src="/technicalnotes/assets/js/2.07677609.js" defer></script><script src="/technicalnotes/assets/js/8.916543f6.js" defer></script><script src="/technicalnotes/assets/js/7.439bcb14.js" defer></script>
  </body>
</html>
