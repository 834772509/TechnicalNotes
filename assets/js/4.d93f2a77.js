(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{448:function(s,t,a){s.exports=a.p+"assets/img/kuangstudyebb6ebca-b5f3-45ce-ae06-ee9899fa0398.35c6f555.png"},449:function(s,t,a){s.exports=a.p+"assets/img/kuangstudy5375096a-4612-4fae-a76c-83c4e82d817b.9643aa04.png"},450:function(s,t,a){s.exports=a.p+"assets/img/kuangstudy2c1ac099-6cb4-48f4-9e18-356538ee7b40.7b4420d2.png"},451:function(s,t,a){s.exports=a.p+"assets/img/kuangstudy55c24afc-de22-4028-aa3c-aeb6cf6a6f9f.22c90f70.png"},452:function(s,t,a){s.exports=a.p+"assets/img/kuangstudyb69524e7-a8fc-4517-b7ba-c8ac22752ae7.a18eb916.png"},453:function(s,t,a){s.exports=a.p+"assets/img/kuangstudy3a77ae60-28ce-4866-b706-c0270f72aaff.377dcfd0.png"},454:function(s,t,a){s.exports=a.p+"assets/img/kuangstudy739b8422-fc80-4425-bda9-fccb3cf5d06d.d02d2860.png"},455:function(s,t,a){s.exports=a.p+"assets/img/kuangstudyf272761f-94ea-4876-911b-e799cbe9ffc7.4631c3e1.png"},456:function(s,t,a){s.exports=a.p+"assets/img/kuangstudy30e38d90-d7a3-42d2-bf41-6960671faade.5cbbdc93.png"},457:function(s,t,a){s.exports=a.p+"assets/img/kuangstudybe416430-40e9-4246-8799-a221a1a034dd.f0707c6c.png"},458:function(s,t,a){s.exports=a.p+"assets/img/kuangstudy8f77faaf-727e-4acb-a9da-5da10c5417cc.167d1b21.png"},459:function(s,t,a){s.exports=a.p+"assets/img/kuangstudy8d1de69f-280f-4372-99d5-6c0e145e24f0.46b50e22.png"},460:function(s,t,a){s.exports=a.p+"assets/img/kuangstudy96df1ea0-f246-4f02-a47b-900d870790e7.0c283ff5.png"},461:function(s,t,a){s.exports=a.p+"assets/img/kuangstudy37de2e6a-c038-41b1-90ec-c8e4c36a46f5.7c89af3e.png"},462:function(s,t,a){s.exports=a.p+"assets/img/kuangstudybd744e77-1e24-41e0-9737-d169690f30cf.16ae7442.png"},463:function(s,t,a){s.exports=a.p+"assets/img/kuangstudy07af1e35-15eb-4529-8d12-ef5ea0c1ea8e.c87fefc3.png"},464:function(s,t,a){s.exports=a.p+"assets/img/kuangstudyaa509032-be45-4ece-ad06-ab89df41112f.7acb5cf3.png"},465:function(s,t,a){s.exports=a.p+"assets/img/kuangstudyb7697c68-22ef-4905-9170-62378aef5f0b.47261c5c.png"},466:function(s,t,a){s.exports=a.p+"assets/img/kuangstudy55cc0f0a-1230-46df-a5dc-771be68096e0.06edc09d.png"},467:function(s,t,a){s.exports=a.p+"assets/img/kuangstudy62bf47da-a420-4fd3-90db-035c70d5280c.81748600.png"},468:function(s,t,a){s.exports=a.p+"assets/img/kuangstudy5d0bfcf4-7830-42d9-a019-6b3fdbf9d82c.92ad3d94.png"},469:function(s,t,a){s.exports=a.p+"assets/img/kuangstudyc57c1644-bd6a-4e74-8d90-764c3a279b6c.afd36a5d.png"},470:function(s,t,a){s.exports=a.p+"assets/img/kuangstudy42018025-d25d-4838-815f-cd683749715b.1d692718.png"},471:function(s,t,a){s.exports=a.p+"assets/img/kuangstudy76398d1b-d43b-4d2c-8960-ab9c66e02182.0c82e786.png"},472:function(s,t,a){s.exports=a.p+"assets/img/kuangstudyf40bb3ef-d6e3-4fcf-b2cf-56a68f3a3936.28951ad5.png"},473:function(s,t,a){s.exports=a.p+"assets/img/kuangstudy599e3dcd-15a1-4996-bb6d-4c25e60a9344.1e96a941.png"},474:function(s,t,a){s.exports=a.p+"assets/img/kuangstudycb118d7b-e673-46f3-8fc8-963b8a26a5d8.a34a1910.png"},475:function(s,t,a){s.exports=a.p+"assets/img/kuangstudy7f2b0bf2-190f-4272-b2a3-857d1c65abc2.1c5ea63d.png"},476:function(s,t,a){s.exports=a.p+"assets/img/kuangstudy33cd03cb-bfd7-4ca8-8d1e-59b87b1370dd.1cf433b7.png"},477:function(s,t,a){s.exports=a.p+"assets/img/kuangstudya3427a43-12f3-4d21-a579-6336f884034b.4ee41bb9.png"},478:function(s,t,a){s.exports=a.p+"assets/img/kuangstudy8a8bbfee-29b9-46a0-9644-f8788e2804d0.0f1de278.png"},479:function(s,t,a){s.exports=a.p+"assets/img/kuangstudyfb28acbd-766d-4818-b6df-2fb889ef1072.425104fe.png"},480:function(s,t,a){s.exports=a.p+"assets/img/地址.3fe08c22.png"},481:function(s,t,a){s.exports=a.p+"assets/img/容器之间通信.daa67473.png"},482:function(s,t,a){s.exports=a.p+"assets/img/docker网络.feba9824.png"},483:function(s,t,a){s.exports=a.p+"assets/img/不同网络之间容器不能联通.971a7bf4.jpg"},484:function(s,t,a){s.exports=a.p+"assets/img/容器的网络配置.9506e84c.png"},613:function(s,t,a){"use strict";a.r(t);var e=a(15),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"概述"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[s._v("#")]),s._v(" 概述")]),s._v(" "),e("h2",{attrs:{id:"简介"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[s._v("#")]),s._v(" 简介")]),s._v(" "),e("p",[s._v("官网：https://www.docker.com/")]),s._v(" "),e("p",[s._v("文档：https://docs.docker.com/docker-for-windows/")]),s._v(" "),e("p",[s._v("命令：https://docs.docker.com/engine/reference/run/")]),s._v(" "),e("p",[s._v("仓库：https://hub.docker.com/")]),s._v(" "),e("p",[s._v("Docker 是一个开源的应用容器引擎。")]),s._v(" "),e("p",[s._v("Docker 的思想来自于集装箱，彼此之间隔离。")]),s._v(" "),e("p",[s._v("Docker 通过隔离机制，可以将服务器利用到极致。")]),s._v(" "),e("p",[s._v("Docker 容器完全使用沙箱机制，相互之间不会有任何接口。")]),s._v(" "),e("h2",{attrs:{id:"结构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#结构"}},[s._v("#")]),s._v(" 结构")]),s._v(" "),e("p",[e("img",{attrs:{src:a(448),alt:"img"}})]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("镜像")]),s._v("（image）：Docker 镜像好比一个模板，可以用来创建"),e("strong",[s._v("容器")]),s._v("（container），一个镜像可以创建多个容器。")]),s._v(" "),e("li",[e("strong",[s._v("容器")]),s._v("（container）：容器可以理解为一个微型的系统。")]),s._v(" "),e("li",[e("strong",[s._v("仓库")]),s._v("（repository）：存放镜像的地方。")])]),s._v(" "),e("h2",{attrs:{id:"底层原理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#底层原理"}},[s._v("#")]),s._v(" 底层原理")]),s._v(" "),e("p",[s._v("Docker 是一个 "),e("strong",[s._v("Client-Server")]),s._v(" 结构的系统。")]),s._v(" "),e("p",[s._v("Docker 的守护进程运行在主机上，通过 Socket 从客户端访问。")]),s._v(" "),e("p",[s._v("Docker Server 接受 "),e("strong",[s._v("Docker-Client")]),s._v(" 的指令。")]),s._v(" "),e("p",[e("img",{attrs:{src:a(449),alt:"img"}})]),s._v(" "),e("h2",{attrs:{id:"和虚拟机的区别"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#和虚拟机的区别"}},[s._v("#")]),s._v(" 和虚拟机的区别")]),s._v(" "),e("p",[s._v("Docker所使用的"),e("strong",[s._v("容器化技术")]),s._v("本质上属于"),e("strong",[s._v("虚拟化技术")]),s._v("。")]),s._v(" "),e("p",[s._v("提到虚拟化技术，最有名的就是"),e("strong",[s._v("虚拟机技术")]),s._v("。")]),s._v(" "),e("blockquote",[e("p",[s._v("虚拟机原理示意图")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(450),alt:"img"}})]),s._v(" "),e("p",[s._v("它有以下明显的缺点：")]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("资源占用多")]),s._v("。启动虚拟机非常占内存，对电脑资源有不小的占用。")]),s._v(" "),e("li",[e("strong",[s._v("冗余步骤多")]),s._v("。启动虚拟机后，还需要进行一些步骤才能进入系统，效率比较低。")]),s._v(" "),e("li",[e("strong",[s._v("启动很慢")]),s._v("。由于虚拟机是虚拟化一整个系统，其启动时间会比较缓慢，一般都需要几分钟。")])]),s._v(" "),e("blockquote",[e("p",[s._v("容器化原理示意图")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(451),alt:"img"}})]),s._v(" "),e("p",[s._v("它不是模拟的完整操作系统，而是基于操作系统封装成了一个个小的运行环境。")]),s._v(" "),e("blockquote",[e("p",[s._v("区别")])]),s._v(" "),e("table",[e("thead",[e("tr",[e("th"),s._v(" "),e("th",[s._v("传统虚拟机")]),s._v(" "),e("th",[s._v("Docker")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[s._v("虚拟内容")]),s._v(" "),e("td",[s._v("硬件 + 完整的操作系统 + 软件")]),s._v(" "),e("td",[s._v("APP + LIB")])]),s._v(" "),e("tr",[e("td",[s._v("大小")]),s._v(" "),e("td",[s._v("笨重，通常几个 G")]),s._v(" "),e("td",[s._v("轻便几个 M 或 KB")])]),s._v(" "),e("tr",[e("td",[s._v("启动速度")]),s._v(" "),e("td",[s._v("慢，分钟级")]),s._v(" "),e("td",[s._v("快，秒级")])])])]),s._v(" "),e("blockquote",[e("p",[s._v("Docker 为什么比 VM 快")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(452),alt:"img"}})]),s._v(" "),e("p",[s._v("Docker 有着比 VM 更少的抽象层。")]),s._v(" "),e("p",[s._v("Docker 主要用的是宿主机的内核，而 VM 需要 "),e("strong",[s._v("Guest OS")]),s._v("。")]),s._v(" "),e("p",[s._v("新建容器的时候，Docker 不需要像 VM 一样重新加载一个操作系统内核，避免了引导的过程。")]),s._v(" "),e("h2",{attrs:{id:"安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),e("p",[s._v("Docker 是用 Go 语言开发的。")]),s._v(" "),e("p",[s._v("Go 语言基于 "),e("strong",[s._v("C")]),s._v(" 和 "),e("strong",[s._v("C++")]),s._v("，所以需要先安装 "),e("strong",[s._v("C")]),s._v(" 和 "),e("strong",[s._v("C++")]),s._v(" 环境。")]),s._v(" "),e("p",[s._v("安装 "),e("strong",[s._v("C")]),s._v(" 环境")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("yum -y install gcc\n")])])]),e("p",[s._v("安装 "),e("strong",[s._v("C++")]),s._v(" 环境")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("yum -y install gcc-c++\n")])])]),e("blockquote",[e("p",[s._v("3、环境准备")])]),s._v(" "),e("p",[s._v("根据 Docker 官网的建议，需要再安装一些环境。")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("yum install -y yum-utils device-mapper-persistent-data lvm2\n")])])]),e("blockquote",[e("p",[s._v("4、设置镜像仓库")])]),s._v(" "),e("p",[s._v("这里官网建议我们安装国外的镜像仓库。")]),s._v(" "),e("p",[s._v("由于对国外的网络限制，国内安装的话会非常慢，并很有可能失败。")]),s._v(" "),e("p",[s._v("推荐国内用户安装阿里云镜像。")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n")])])]),e("blockquote",[e("p",[s._v("5、更新 yum 软件包索引")])]),s._v(" "),e("p",[s._v("这里官网建议我们更新 yum 软件包索引：")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("yum makecache fast\n")])])]),e("blockquote",[e("p",[s._v("6、安装 Docker")])]),s._v(" "),e("p",[s._v("做完前面的准备工作，就可以开始安装 Docker 了")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("yum -y install docker-ce docker-ce-cli containerd.io\n")])])]),e("p",[s._v("这里的 "),e("code",[s._v("docker-ce")]),s._v(" 指的是 Docker 的社区版。")]),s._v(" "),e("p",[s._v("如果是需要企业版的话就改为 "),e("code",[s._v("docker-ee")]),s._v(" ，不过企业版是收费的，而且功能也略有不同。")]),s._v(" "),e("p",[s._v("官方更推荐社区版，所以这里我们安装"),e("code",[s._v("docker-ce")]),s._v("。")]),s._v(" "),e("h2",{attrs:{id:"命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#命令"}},[s._v("#")]),s._v(" 命令")]),s._v(" "),e("p",[e("img",{attrs:{src:a(453),alt:"img"}})]),s._v(" "),e("h1",{attrs:{id:"基本命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#基本命令"}},[s._v("#")]),s._v(" 基本命令")]),s._v(" "),e("h2",{attrs:{id:"帮助"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#帮助"}},[s._v("#")]),s._v(" 帮助")]),s._v(" "),e("h3",{attrs:{id:"docker-help"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-help"}},[s._v("#")]),s._v(" docker —help")]),s._v(" "),e("p",[s._v("Docker 的帮助命令是一个"),e("strong",[s._v("万能命令")]),s._v("，可以用来查看 Docker 的"),e("strong",[s._v("所有命令")]),s._v("。")]),s._v(" "),e("blockquote",[e("p",[s._v("语法")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("命令"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" --help\n")])])]),e("blockquote",[e("p",[s._v("查看镜像相关命令")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images --help")]),s._v("\nUsage:  "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OPTIONS"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("REPOSITORY"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(":TAG"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nList images\nOptions:\n  -a, --all             Show all images "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default hides intermediate images"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      --digests         Show digests\n  -f, --filter filter   Filter output based on conditions provided\n      --format string   Pretty-print images using a Go template\n      --no-trunc        Don't truncate output\n  -q, --quiet           Only show image IDs\n")])])]),e("blockquote",[e("p",[s._v("查看容器相关命令")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps --help")]),s._v("\nUsage:  "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OPTIONS"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nList containers\nOptions:\n  -a, --all             Show all containers "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default shows just running"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  -f, --filter filter   Filter output based on conditions provided\n      --format string   Pretty-print containers using a Go template\n  -n, --last int        Show n last created containers "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("includes all states"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default -1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  -l, --latest          Show the latest created container "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("includes all states"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      --no-trunc        Don't truncate output\n  -q, --quiet           Only display container IDs\n  -s, --size            Display total "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" sizes\n")])])]),e("h2",{attrs:{id:"基本信息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#基本信息"}},[s._v("#")]),s._v(" 基本信息")]),s._v(" "),e("h3",{attrs:{id:"docker-version"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-version"}},[s._v("#")]),s._v(" docker version")]),s._v(" "),e("p",[s._v("使用 "),e("code",[s._v("docker version")]),s._v(" 命令可以查看 Docker 的基本信息。")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker version")]),s._v("\nClient: Docker Engine - Community\n Version:           "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.10")]),s._v(".11\n API version:       "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.41")]),s._v("\n Go version:        go1.16.9\n Git commit:        dea9396\n Built:             Thu Nov "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" 00:38:53 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("\n OS/Arch:           linux/amd64\n Context:           default\n Experimental:      "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\nServer: Docker Engine - Community\n Engine:\n  Version:          "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.10")]),s._v(".11\n  API version:      "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.41")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum version "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.12")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  Go version:       go1.16.9\n  Git commit:       847da18\n  Built:            Thu Nov "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" 00:37:17 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("\n  OS/Arch:          linux/amd64\n  Experimental:     "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n containerd:\n  Version:          "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.4")]),s._v(".12\n  GitCommit:        7b11cfaabd73bb80907dd23182b9347b4245eb5d\n runc:\n  Version:          "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v(".2\n  GitCommit:        v1.0.2-0-g52b36a2\n docker-init:\n  Version:          "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.19")]),s._v(".0\n  GitCommit:        de40ad0\n")])])]),e("h2",{attrs:{id:"系统信息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#系统信息"}},[s._v("#")]),s._v(" 系统信息")]),s._v(" "),e("h3",{attrs:{id:"docker-info"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-info"}},[s._v("#")]),s._v(" docker info")]),s._v(" "),e("p",[s._v("使用 "),e("code",[s._v("docker info")]),s._v(" 命令可以查看 Docker 的系统信息。")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker info")]),s._v("\nClient:\n Context:    default\n Debug Mode: "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n Plugins:\n  app: Docker App "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Docker Inc., v0.9.1-beta3"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  buildx: Build with BuildKit "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Docker Inc., v0.6.3-docker"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  scan: Docker Scan "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Docker Inc., v0.9.0"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nServer:\n Containers: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n  Running: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n  Paused: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n  Stopped: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n Images: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n Server Version: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.10")]),s._v(".11\n Storage Driver: overlay2\n  Backing Filesystem: extfs\n  Supports d_type: "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n  Native Overlay Diff: "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n  userxattr: "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n Logging Driver: json-file\n Cgroup Driver: cgroupfs\n Cgroup Version: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n Plugins:\n  Volume: "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n  Network: bridge "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" ipvlan macvlan null overlay\n  Log: awslogs fluentd gcplogs gelf journald json-file "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" logentries splunk syslog\n Swarm: inactive\n Runtimes: io.containerd.runc.v2 io.containerd.runtime.v1.linux runc\n Default Runtime: runc\n Init Binary: docker-init\n containerd version: 7b11cfaabd73bb80907dd23182b9347b4245eb5d\n runc version: v1.0.2-0-g52b36a2\n init version: de40ad0\n Security Options:\n  seccomp\n   Profile: default\n Kernel Version: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.10")]),s._v(".0-957.21.3.el7.x86_64\n Operating System: CentOS Linux "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Core"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n OSType: linux\n Architecture: x86_64\n CPUs: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n Total Memory: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".694GiB\n Name: sail\n ID: 2GYU:CVF3:LSAL:J37H:TGME:AOCA:BROB:PHCD:ZPN2:BQCG:GXHB:7Q3L\n Docker Root Dir: /var/lib/docker\n Debug Mode: "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n Registry: https://index.docker.io/v1/\n Labels:\n Experimental: "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n Insecure Registries:\n  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.0/8\n Registry Mirrors:\n  https://l6b75cm0.mirror.aliyuncs.com/\n Live Restore Enabled: "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n")])])]),e("h1",{attrs:{id:"镜像命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#镜像命令"}},[s._v("#")]),s._v(" 镜像命令")]),s._v(" "),e("h2",{attrs:{id:"查看所有镜像"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看所有镜像"}},[s._v("#")]),s._v(" 查看所有镜像")]),s._v(" "),e("h3",{attrs:{id:"docker-images"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-images"}},[s._v("#")]),s._v(" docker images")]),s._v(" "),e("p",[s._v("可以使用 "),e("code",[s._v("docker images")]),s._v(" 命令查看所有本地主机上的镜像。")]),s._v(" "),e("blockquote",[e("p",[s._v("该命令等价于 "),e("code",[s._v("docker image ls")]),s._v("。")]),s._v(" "),e("p",[s._v("语法")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("docker images [参数] [镜像[:标签]]\n")])])]),e("p",[s._v("命令后加上 [镜像[:标签]] 可以对镜像进行过滤。")]),s._v(" "),e("blockquote",[e("p",[s._v("参数")])]),s._v(" "),e("ul",[e("li",[e("code",[s._v("-a")]),s._v("：显示所有镜像。")]),s._v(" "),e("li",[e("code",[s._v("-q")]),s._v("：只显示 ID。")])]),s._v(" "),e("blockquote",[e("p",[s._v("显示所有镜像")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" image "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images -a\n")])])]),e("blockquote",[e("p",[s._v("只显示镜像的 ID")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" image -q\n")])])]),e("blockquote",[e("p",[s._v("显示所有镜像的 ID")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images -aq\n")])])]),e("blockquote",[e("p",[s._v("对镜像进行过滤")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("docker images 镜像名:版本号\n")])])]),e("blockquote",[e("p",[s._v("结果分析")])]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("REPOSITORY")]),s._v("：镜像名（镜像仓库源）。")]),s._v(" "),e("li",[e("strong",[s._v("TAG")]),s._v("：镜像的标签。")]),s._v(" "),e("li",[e("strong",[s._v("IMAGE ID")]),s._v("：镜像的 ID。")]),s._v(" "),e("li",[e("strong",[s._v("CREATED")]),s._v("：镜像的创建时间。")]),s._v(" "),e("li",[e("strong",[s._v("SIZE")]),s._v("：镜像的大小。")])]),s._v(" "),e("h2",{attrs:{id:"搜索镜像"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#搜索镜像"}},[s._v("#")]),s._v(" 搜索镜像")]),s._v(" "),e("h3",{attrs:{id:"docker-search"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-search"}},[s._v("#")]),s._v(" docker search")]),s._v(" "),e("blockquote",[e("p",[s._v("语法")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("docker search [参数]\n")])])]),e("blockquote",[e("p",[s._v("参数")])]),s._v(" "),e("ul",[e("li",[e("code",[s._v("-f")]),s._v(" / "),e("code",[s._v("--filter")]),s._v("：根据过滤条件搜索。")])]),s._v(" "),e("blockquote",[e("p",[s._v("搜索仓库中的镜像，等价于网页搜索。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" search mysql\n")])])]),e("blockquote",[e("p",[s._v("搜索出 Stars 大于 3000 的")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" search mysql -f"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("STARS"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),s._v("\n")])])]),e("h2",{attrs:{id:"拉取镜像"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#拉取镜像"}},[s._v("#")]),s._v(" 拉取镜像")]),s._v(" "),e("h3",{attrs:{id:"docker-pull"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-pull"}},[s._v("#")]),s._v(" docker pull")]),s._v(" "),e("blockquote",[e("p",[s._v("语法")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("docker pull [参数] 镜像名[:标签]\n")])])]),e("blockquote",[e("p",[s._v("如果不输入标签，默认拉取最新版镜像。")]),s._v(" "),e("p",[s._v("参数")])]),s._v(" "),e("ul",[e("li",[e("code",[s._v("-a")]),s._v("：拉取镜像的所有标签。")]),s._v(" "),e("li",[e("code",[s._v("-q")]),s._v("：抑制详细输出。")])]),s._v(" "),e("blockquote",[e("p",[s._v("默认下载最新版")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull redis\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#输出信息")]),s._v("\nUsing default tag: latest "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认最新版标签")]),s._v("\nlatest: Pulling from library/redis\ne5ae68f74026: Pull complete "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分层下载，docker image的核心：联合文件系统")]),s._v("\n37c4354629da: Pull complete \nb065b1b1fa0f: Pull complete \n6954d19bb2e5: Pull complete \n6333f8baaf7c: Pull complete \nf9772c8a44e7: Pull complete \nDigest: sha256:2f502d27c3e9b54295f1c591b3970340d02f8a5824402c8179dcd20d4076b796 "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#防伪签名")]),s._v("\nStatus: Downloaded newer image "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" redis:latest\ndocker.io/library/redis:latest "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 真实地址，docker pull redis 等价于 docker pull docker.io/library/redis:latest")]),s._v("\n")])])]),e("blockquote",[e("p",[s._v("指定版本下载")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull redis:5.0\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#输出信息")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.0")]),s._v(": Pulling from library/redis\ne5ae68f74026: Already exists "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分层镜像的好处，与之前的版本共用一部分，不用再重复下载")]),s._v("\n37c4354629da: Already exists \nb065b1b1fa0f: Already exists \n99ab464ba8bb: Pull complete \neb5bbe3179d2: Pull complete \n2067794f93b6: Pull complete \nDigest: sha256:310f81701011175dc868e833d73f539282dd18510ca35d6f7b63c4d33ab4f54e\nStatus: Downloaded newer image "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" redis:5.0\ndocker.io/library/redis:5.0\n")])])]),e("p",[s._v("版本来自于官网，版本库 https://hub.docker.com/_/redis")]),s._v(" "),e("p",[e("img",{attrs:{src:a(454),alt:"img"}})]),s._v(" "),e("blockquote",[e("p",[s._v("这里输入的标签必须是官网版本库存在的标签，否则无法拉取镜像。")])]),s._v(" "),e("h2",{attrs:{id:"删除镜像"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#删除镜像"}},[s._v("#")]),s._v(" 删除镜像")]),s._v(" "),e("h3",{attrs:{id:"docker-rmi"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-rmi"}},[s._v("#")]),s._v(" docker rmi")]),s._v(" "),e("blockquote",[e("p",[s._v("语法")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("参数"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" 镜像 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("镜像"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),e("blockquote",[e("p",[s._v("参数")])]),s._v(" "),e("ul",[e("li",[e("code",[s._v("-f")]),s._v("：强制删除。")])]),s._v(" "),e("blockquote",[e("p",[s._v("查看现存镜像")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\n")])])]),e("blockquote",[e("p",[s._v("删除一个。可以通过名称，也可以指定 ID，"),e("code",[s._v("-f")]),s._v(" 表示强制删除。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi -f 镜像id\n")])])]),e("blockquote",[e("p",[s._v("删除多个。用空格分隔 ID。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi -f 镜像a的id 镜像b的id\n")])])]),e("blockquote",[e("p",[s._v("删除所有。先用 "),e("code",[s._v("docker images -aq")]),s._v(" 查询出所有镜像，再使用 "),e("code",[s._v("docker rmi -f")]),s._v(" 递归删除。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi -f "),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images -aq"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n")])])]),e("h2",{attrs:{id:"运行镜像"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#运行镜像"}},[s._v("#")]),s._v(" 运行镜像")]),s._v(" "),e("h3",{attrs:{id:"docker-run"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-run"}},[s._v("#")]),s._v(" docker run")]),s._v(" "),e("blockquote",[e("p",[s._v("语法")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("docker run [参数] 镜像名\n")])])]),e("blockquote",[e("p",[s._v("参数")])]),s._v(" "),e("ul",[e("li",[e("p",[e("code",[s._v("--name")]),s._v("：指定容器的名称，如果正在运行该名称的容器，会报错。")])]),s._v(" "),e("li",[e("p",[e("code",[s._v("--rm")]),s._v("：用完即删除，通常用来测试。")])]),s._v(" "),e("li",[e("p",[e("code",[s._v("-d")]),s._v("：后台方式运行。")])]),s._v(" "),e("li",[e("p",[e("code",[s._v("-it")]),s._v("：使用交互方式运行，可以进入容器查看内容。")])]),s._v(" "),e("li",[e("p",[e("code",[s._v("-e")]),s._v("：指定运行环境。")])]),s._v(" "),e("li",[e("p",[e("code",[s._v("-p")]),s._v("：随机指定端口。")])]),s._v(" "),e("li",[e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("-p\n")])])]),e("p",[s._v("：指定容器的端口，如：")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("-p 8080:8080\n")])])]),e("p",[s._v("。还可以有以下写法：")]),s._v(" "),e("ul",[e("li",[e("code",[s._v("-p ip:主机端口:容器端口")])]),s._v(" "),e("li",[e("code",[s._v("-p 主机端口:容器端口")])]),s._v(" "),e("li",[e("code",[s._v("-p 容器端口")])])])])]),s._v(" "),e("blockquote",[e("p",[s._v("运行 centos 镜像")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -it centos /bin/bash\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#输出信息")]),s._v("\nUnable to "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" image "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'centos:latest'")]),s._v(" locally "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 检索本地镜像，发现没有该镜像，则去仓库中搜索。")]),s._v("\nlatest: Pulling from library/centos "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开始从仓库中拉取")]),s._v("\na1d0c7532777: Pull complete \nDigest: sha256:a27fd8080b517143cbbbab9dfb7c8571c40d67d534bbdee55bd6c473f432b177\nStatus: Downloaded newer image "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" centos:latest\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@81c83ea42dc0 /"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls # 由于是以交互方式运行，且进入 /bin/bash 中，此时的路径即为 centos 容器中的 /bin/bash")]),s._v("\nbin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var\n")])])]),e("blockquote",[e("p",[s._v("由此可以看出，容器就是一个微型的 Linux 系统。它只保留了最核心的功能和最基本的命令，方便进行操作。")])]),s._v(" "),e("h1",{attrs:{id:"容器命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#容器命令"}},[s._v("#")]),s._v(" 容器命令")]),s._v(" "),e("h2",{attrs:{id:"查看容器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看容器"}},[s._v("#")]),s._v(" 查看容器")]),s._v(" "),e("h3",{attrs:{id:"docker-ps"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-ps"}},[s._v("#")]),s._v(" docker ps")]),s._v(" "),e("blockquote",[e("p",[s._v("语法")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("参数"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),e("blockquote",[e("p",[s._v("参数")])]),s._v(" "),e("ul",[e("li",[e("code",[s._v("-a")]),s._v("：查看所有容器（包括正在运行的和已经停止的）。")]),s._v(" "),e("li",[e("code",[s._v("-n")]),s._v("：显示最近创建的容器，设置显示个数。")]),s._v(" "),e("li",[e("code",[s._v("-q")]),s._v("：只显示容器的编号。")])]),s._v(" "),e("blockquote",[e("p",[s._v("查看正在运行的容器")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出内容")]),s._v("\nCONTAINER ID   IMAGE     COMMAND       CREATED              STATUS              PORTS     NAMES\n1aaf76d85b9e   centos    "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),s._v("   About a minute ago   Up About a minute             intelligent_proskuriakova\n")])])]),e("blockquote",[e("p",[s._v("查看所有容器")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -a\n")])])]),e("blockquote",[e("p",[s._v("显示最近创建的 2 个容器")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -a -n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n")])])]),e("blockquote",[e("p",[s._v("只显示容器的 ID")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -aq\n")])])]),e("h2",{attrs:{id:"退出容器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#退出容器"}},[s._v("#")]),s._v(" 退出容器")]),s._v(" "),e("h3",{attrs:{id:"exit"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#exit"}},[s._v("#")]),s._v(" exit")]),s._v(" "),e("p",[s._v("进入容器后，可以使用 "),e("code",[s._v("exit")]),s._v(" 退出")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#先运行一个容器")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -it centos /bin/bash\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#退出容器")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n")])])]),e("p",[s._v("由此可见，这样退出后容器也会停止。")]),s._v(" "),e("h3",{attrs:{id:"ctrl-p-q"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ctrl-p-q"}},[s._v("#")]),s._v(" Ctrl + P + Q")]),s._v(" "),e("p",[s._v("如果想退出后容器不停止，可以使用 "),e("code",[s._v("Ctrl + P + Q")]),s._v(" 快捷键退出。")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#运行一个容器")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -it centos /bin/bash\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#使用ctrl + P + Q 快捷键退出后 在查看运行的容器")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" \nCONTAINER ID   IMAGE     COMMAND       CREATED         STATUS         PORTS     NAMES\n1aaf76d85b9e   centos    "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),s._v("   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" seconds ago   Up "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" seconds             intelligent_proskuriakova\n")])])]),e("h2",{attrs:{id:"删除容器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#删除容器"}},[s._v("#")]),s._v(" 删除容器")]),s._v(" "),e("h3",{attrs:{id:"docker-rm"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-rm"}},[s._v("#")]),s._v(" docker rm")]),s._v(" "),e("blockquote",[e("p",[s._v("语法")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("docker rm [参数] 容器 [容器...]\n")])])]),e("blockquote",[e("p",[s._v("参数")])]),s._v(" "),e("ul",[e("li",[e("code",[s._v("-f")]),s._v("：强制删除。")])]),s._v(" "),e("blockquote",[e("p",[s._v("删除指定容器（不能删除正在运行的容器）")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#假设 1aaf76d85b9e这个容器正在运行，进行删除")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" 1aaf76d85b9e\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#提示你需要停止后在删除")]),s._v("\nError response from daemon: You cannot remove a running container 1aaf76d85b9ee5002411c1ea390fca05819f19dc400e85127731d37455cb0acc. Stop the container before attempting removal or force remove\n")])])]),e("blockquote",[e("p",[s._v("强制删除指定容器")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f 容器id\n")])])]),e("blockquote",[e("p",[s._v("删除所有容器。先使用 "),e("code",[s._v("docker ps -aq")]),s._v(" 获取所有容器的 ID，再调用 "),e("code",[s._v("docker rm -f")]),s._v(" 递归删除。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f "),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -aq"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n")])])]),e("blockquote",[e("p",[s._v("删除所有容器。使用管道符 "),e("code",[s._v("|")]),s._v(" 获取 Docker 相关的所有容器 ID 并使用 "),e("code",[s._v("docker rm -f")]),s._v(" 删除。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -a -q"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("xargs")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f\n")])])]),e("h2",{attrs:{id:"启动容器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动容器"}},[s._v("#")]),s._v(" 启动容器")]),s._v(" "),e("h3",{attrs:{id:"docker-start"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-start"}},[s._v("#")]),s._v(" docker start")]),s._v(" "),e("blockquote",[e("p",[s._v("运行关闭的容器")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" start 容器id\n")])])]),e("h2",{attrs:{id:"关闭容器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#关闭容器"}},[s._v("#")]),s._v(" 关闭容器")]),s._v(" "),e("h3",{attrs:{id:"docker-stop"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-stop"}},[s._v("#")]),s._v(" docker stop")]),s._v(" "),e("blockquote",[e("p",[s._v("关闭运行的容器")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop 容器id\n")])])]),e("h2",{attrs:{id:"重启容器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#重启容器"}},[s._v("#")]),s._v(" 重启容器")]),s._v(" "),e("h3",{attrs:{id:"docker-restart"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-restart"}},[s._v("#")]),s._v(" docker restart")]),s._v(" "),e("blockquote",[e("p",[s._v("重启关闭的容器")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" restart 容器id\n")])])]),e("h2",{attrs:{id:"杀掉容器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#杀掉容器"}},[s._v("#")]),s._v(" 杀掉容器")]),s._v(" "),e("h3",{attrs:{id:"docker-kill"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-kill"}},[s._v("#")]),s._v(" docker kill")]),s._v(" "),e("blockquote",[e("p",[s._v("杀掉运行的容器")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" 容器id\n")])])]),e("h1",{attrs:{id:"常用命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#常用命令"}},[s._v("#")]),s._v(" 常用命令")]),s._v(" "),e("h2",{attrs:{id:"启动-docker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动-docker"}},[s._v("#")]),s._v(" 启动 Docker")]),s._v(" "),e("h3",{attrs:{id:"systemctl-start-docker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#systemctl-start-docker"}},[s._v("#")]),s._v(" systemctl start docker")]),s._v(" "),e("p",[s._v("在服务器关机或者重启后，是需要重新启动 Docker 的。 命令如下：")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("systemctl start "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])])]),e("h2",{attrs:{id:"查看日志"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看日志"}},[s._v("#")]),s._v(" 查看日志")]),s._v(" "),e("h3",{attrs:{id:"docker-logs"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-logs"}},[s._v("#")]),s._v(" docker logs")]),s._v(" "),e("blockquote",[e("p",[s._v("语法")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v(" docker logs [参数] 容器\n")])])]),e("blockquote",[e("p",[s._v("参数")])]),s._v(" "),e("ul",[e("li",[e("code",[s._v("-f")]),s._v("：日志流动输出。")]),s._v(" "),e("li",[e("code",[s._v("-t")]),s._v("：展示时间戳。")]),s._v(" "),e("li",[e("code",[s._v("--tail")]),s._v("：从日志末尾显示的行数。")])]),s._v(" "),e("blockquote",[e("p",[s._v("为模拟日志输出效果，我们先编写一段脚本")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("while true;do echo sail;sleep 3;done\n")])])]),e("p",[s._v("以上脚本实现的效果为：每隔 3 秒输出字符串 sail。")]),s._v(" "),e("blockquote",[e("p",[s._v("以脚本启动容器")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动容器")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d centos /bin/sh -c "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"while true;do echo sail;sleep 3;done"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看该容器的日志信息")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" logs -f -t --tail "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" 容器id\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-12-10T03:01:28.607288480Z sail\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-12-10T03:01:31.609334595Z sail\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-12-10T03:01:34.611361943Z sail\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-12-10T03:01:37.613461457Z sail\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-12-10T03:01:40.615619089Z sail\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-12-10T03:01:43.617595572Z sail\n")])])]),e("p",[s._v("可以看到，按此命令会看到容器最后 10 条日志，且每隔 3 秒滚动输出一条日志。")]),s._v(" "),e("h2",{attrs:{id:"后台启动"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#后台启动"}},[s._v("#")]),s._v(" 后台启动")]),s._v(" "),e("h3",{attrs:{id:"docker-run-d"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-run-d"}},[s._v("#")]),s._v(" docker run -d")]),s._v(" "),e("blockquote",[e("p",[s._v("语法")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("docker run -d 镜像\n")])])]),e("blockquote",[e("p",[s._v("后台启动镜像")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d centos\n")])])]),e("blockquote",[e("p",[s._v("使用 "),e("code",[s._v("docker run -d")]),s._v(" 启动，也并不能保证容器一定能在后台运行，如果没有前台使用，容器启动后发现自己没有提供服务，会立刻停止。")])]),s._v(" "),e("p",[s._v("前面的 "),e("code",[s._v('docker run -d centos /bin/sh -c "while true;do echo sail;sleep 3;done"')]),s._v(" 命令，由于启动后运行了脚本打印日志，即提供了服务，所以不会停止。")]),s._v(" "),e("h2",{attrs:{id:"查看容器信息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看容器信息"}},[s._v("#")]),s._v(" 查看容器信息")]),s._v(" "),e("h3",{attrs:{id:"docker-inspect"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-inspect"}},[s._v("#")]),s._v(" docker inspect")]),s._v(" "),e("blockquote",[e("p",[s._v("语法")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" inspect 容器\n")])])]),e("blockquote",[e("p",[s._v("示例")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" inspect 容器id\n")])])]),e("blockquote",[e("p",[s._v("不管容器是否运行，都可以使用该命令查看。")])]),s._v(" "),e("h2",{attrs:{id:"进入正在运行的容器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#进入正在运行的容器"}},[s._v("#")]),s._v(" 进入正在运行的容器")]),s._v(" "),e("p",[s._v("容器是一个微型的 Linux 系统，我们通常需要进入容器进行操作。")]),s._v(" "),e("h3",{attrs:{id:"docker-exec"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-exec"}},[s._v("#")]),s._v(" docker exec")]),s._v(" "),e("p",[s._v("使用 "),e("code",[s._v("docker exec")]),s._v(" 可以进入容器并开启一个新的终端，可以在里面操作。")]),s._v(" "),e("blockquote",[e("p",[s._v("语法")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("docker exec [参数] 容器 路径\n")])])]),e("blockquote",[e("p",[s._v("参数")])]),s._v(" "),e("ul",[e("li",[e("code",[s._v("-d")]),s._v("：后台运行。")]),s._v(" "),e("li",[e("code",[s._v("-it")]),s._v("：交互模式进入。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it 容器id /bin/bash\n")])])]),e("p",[s._v("这种进入方式是单独开了一个新进程的方式。")]),s._v(" "),e("h3",{attrs:{id:"docker-attach"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-attach"}},[s._v("#")]),s._v(" docker attach")]),s._v(" "),e("p",[s._v("使用 "),e("code",[s._v("docker attach")]),s._v(" 会进入容器正在执行的终端，不会启动新的进程。")]),s._v(" "),e("blockquote",[e("p",[s._v("语法")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" attach 容器id\n")])])]),e("p",[s._v("这种进入方式没有开启新的进程（"),e("code",[s._v("/bin/bash")]),s._v(" 是 centos 容器的默认终端）。")]),s._v(" "),e("h2",{attrs:{id:"从容器内拷贝文件到主机"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#从容器内拷贝文件到主机"}},[s._v("#")]),s._v(" 从容器内拷贝文件到主机")]),s._v(" "),e("blockquote",[e("p",[s._v("进入容器，创建一个文件")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入容器")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" attach 96ed3fe3e7f1\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入home目录")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /home\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建一个文件")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" test.java \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看文件")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#test.java")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#退出容器")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n")])])]),e("blockquote",[e("p",[s._v("退出容器后，不管容器是否启动，都可以复制容器中的文件到主机上")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入主机上的home目录")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /home\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#复制")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" 容器id:/home/test.java /home\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看home目录下的文件")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\nadmin  f2  f3  sail  test.java\n")])])]),e("blockquote",[e("p",[s._v("这种方式是一个手动过程，很不方便，推荐使用"),e("strong",[s._v("数据卷技术")]),s._v("，可以实现自动同步主机和容器的目录。")])]),s._v(" "),e("h2",{attrs:{id:"查看docker内存占用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看docker内存占用"}},[s._v("#")]),s._v(" 查看Docker内存占用")]),s._v(" "),e("h3",{attrs:{id:"docker-stats"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-stats"}},[s._v("#")]),s._v(" docker stats")]),s._v(" "),e("blockquote",[e("p",[s._v("语法")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stats "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("参数"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("容器"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),e("blockquote",[e("p",[s._v("参数")])]),s._v(" "),e("ul",[e("li",[e("code",[s._v("-a")]),s._v("：查看所有容器的内存占用（默认只展示运行的容器）。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stats -a\n")])])]),e("h1",{attrs:{id:"镜像原理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#镜像原理"}},[s._v("#")]),s._v(" 镜像原理")]),s._v(" "),e("h2",{attrs:{id:"联合文件系统"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#联合文件系统"}},[s._v("#")]),s._v(" 联合文件系统")]),s._v(" "),e("p",[e("strong",[s._v("联合文件系统")]),s._v("（UnionFS）是 Docker 的核心，也是 Docker 得以极致精简的保证。")]),s._v(" "),e("p",[s._v("以拉取 redis 镜像为例")]),s._v(" "),e("blockquote",[e("p",[s._v("先拉取最新版镜像")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull redis\nUsing default tag: latest "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认最新版标签")]),s._v("\nlatest: Pulling from library/redis\ne5ae68f74026: Pull complete "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分层下载，docker image的核心：联合文件系统")]),s._v("\n37c4354629da: Pull complete \nb065b1b1fa0f: Pull complete \n6954d19bb2e5: Pull complete \n6333f8baaf7c: Pull complete \nf9772c8a44e7: Pull complete \nDigest: sha256:2f502d27c3e9b54295f1c591b3970340d02f8a5824402c8179dcd20d4076b796 "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#防伪签名")]),s._v("\nStatus: Downloaded newer image "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" redis:latest\ndocker.io/library/redis:latest "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 真实地址，docker pull redis 等价于 docker pull docker.io/library/redis:latest")]),s._v("\n")])])]),e("blockquote",[e("p",[s._v("再拉取指定版镜像")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull redis:5.0\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.0")]),s._v(": Pulling from library/redis\ne5ae68f74026: Already exists "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分层镜像的好处，与之前的版本共用一部分，不用再重复下载")]),s._v("\n37c4354629da: Already exists \nb065b1b1fa0f: Already exists \n99ab464ba8bb: Pull complete \neb5bbe3179d2: Pull complete \n2067794f93b6: Pull complete \nDigest: sha256:310f81701011175dc868e833d73f539282dd18510ca35d6f7b63c4d33ab4f54e\nStatus: Downloaded newer image "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" redis:5.0\ndocker.io/library/redis:5.0\n")])])]),e("p",[s._v("由此可见，redis 镜像一共 6 层，由于之前拉取了默认的最新版 "),e("strong",[s._v("redis")]),s._v(" 镜像，再拉取 "),e("strong",[s._v("redis:5.0")]),s._v(" 时，有 3 层是可以复用的，所以只下载了不能复用的 3 层。")]),s._v(" "),e("blockquote",[e("p",[s._v("这样既能提高下载速度，也能极大节省磁盘占用和资源消耗。")])]),s._v(" "),e("h2",{attrs:{id:"分层镜像"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#分层镜像"}},[s._v("#")]),s._v(" 分层镜像")]),s._v(" "),e("p",[s._v("Docker 使用联合文件系统对镜像做了分层，如下图所示：")]),s._v(" "),e("p",[e("img",{attrs:{src:a(455),alt:"img"}})]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("bootfs")]),s._v("（boot file system）：启动文件系统。")]),s._v(" "),e("li",[e("strong",[s._v("rootfs")]),s._v("：root file system：基础文件系统。")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(456),alt:"img"}})]),s._v(" "),e("p",[e("img",{attrs:{src:a(457),alt:"img"}})]),s._v(" "),e("p",[e("img",{attrs:{src:a(458),alt:"img"}})]),s._v(" "),e("p",[s._v("Docker 镜像都是"),e("strong",[s._v("只读")]),s._v("的，当容器启动时，一个新的可写层被加到镜像的顶部。")]),s._v(" "),e("p",[s._v("这一层就是我们通常说的"),e("strong",[s._v("容器层")]),s._v("，容器层之下的都叫"),e("strong",[s._v("镜像层")]),s._v("。")]),s._v(" "),e("p",[e("img",{attrs:{src:a(459),alt:"img"}})]),s._v(" "),e("h2",{attrs:{id:"自定义镜像"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#自定义镜像"}},[s._v("#")]),s._v(" 自定义镜像")]),s._v(" "),e("p",[s._v("我们日常拉取的镜像是由别人制作再提交到仓库的。")]),s._v(" "),e("p",[s._v("我们自己也是可以制作镜像并提交的，使用 "),e("code",[s._v("docker commit")]),s._v(" 命令。")]),s._v(" "),e("h3",{attrs:{id:"提交镜像"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#提交镜像"}},[s._v("#")]),s._v(" 提交镜像")]),s._v(" "),e("h4",{attrs:{id:"docker-commit"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-commit"}},[s._v("#")]),s._v(" docker commit")]),s._v(" "),e("blockquote",[e("p",[s._v("语法")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" commit "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("参数"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" 容器 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("仓库"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(":标签"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),e("blockquote",[e("p",[s._v("参数")])]),s._v(" "),e("ul",[e("li",[e("code",[s._v("-a")]),s._v("：作者信息。一般为 "),e("strong",[s._v("作者名字<邮箱>")]),s._v("。")]),s._v(" "),e("li",[e("code",[s._v("-c")]),s._v("：将 "),e("strong",[s._v("Dockerfile")]),s._v(" 指令应用于创建的映像。")]),s._v(" "),e("li",[e("code",[s._v("-m")]),s._v("：注释信息。")]),s._v(" "),e("li",[e("code",[s._v("-p")]),s._v("：提交期间暂停容器（默认）。")])]),s._v(" "),e("blockquote",[e("p",[s._v("提交自定义镜像")])]),s._v(" "),e("blockquote",[e("p",[s._v("将这个容器创建为一个自定义的镜像并提交到仓库中。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" commit -a"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"提交人信息"')]),s._v(" -m"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"注释信息"')]),s._v(" 要提交的容器 镜像名:版本号\n")])])]),e("h1",{attrs:{id:"数据卷"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#数据卷"}},[s._v("#")]),s._v(" 数据卷")]),s._v(" "),e("h2",{attrs:{id:"由来"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#由来"}},[s._v("#")]),s._v(" 由来")]),s._v(" "),e("p",[s._v("Docker 是将应用和环境打包成一个镜像。")]),s._v(" "),e("p",[s._v("这样，数据就不应该保存在容器中，否则容器删除，数据就会丢失，有着非常大的风险。")]),s._v(" "),e("p",[s._v("为此，容器和主机之间需要有一个数据共享技术，使得在 Docker 容器中产生的数据能够同步到本地。")]),s._v(" "),e("p",[s._v("这就是"),e("strong",[s._v("数据卷")]),s._v("技术。其本质上是一个"),e("strong",[s._v("目录挂载")]),s._v("，将容器内的目录挂载到主机上。")]),s._v(" "),e("h2",{attrs:{id:"使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[s._v("#")]),s._v(" 使用")]),s._v(" "),e("h3",{attrs:{id:"命令方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#命令方式"}},[s._v("#")]),s._v(" 命令方式")]),s._v(" "),e("blockquote",[e("p",[s._v("语法")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -v 主机目录:容器目录\n")])])]),e("blockquote",[e("p",[s._v("查看主机 "),e("code",[s._v("/home")]),s._v(" 目录。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" /home\nadmin  f2  f3  sail  test.java\n")])])]),e("blockquote",[e("p",[s._v("以交互模式启动 centos 镜像。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -it -v /home/ceshi:/home centos /bin/bash")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ec95646b1a4c /"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n")])])]),e("blockquote",[e("p",[s._v("新开一个窗口查看容器详情。")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(460),alt:"img"}})]),s._v(" "),e("p",[e("strong",[s._v("Mounts")]),s._v(" 下的 "),e("strong",[s._v("Source")]),s._v(" 即为设置的主机目录、"),e("strong",[s._v("Destination")]),s._v(" 即为设置的容器目录，他们已经绑定在了一起。")]),s._v(" "),e("blockquote",[e("p",[s._v("在主机中查看 "),e("code",[s._v("/home")]),s._v("。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs /"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /home")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs home"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nadmin  ceshi  f2  f3  sail  test.java\n")])])]),e("p",[s._v("主机上的 "),e("code",[s._v("/home")]),s._v(" 下已经有了 "),e("code",[s._v("ceshi")]),s._v(" 目录。说明容器一经启动，就会在主机生成对应的挂载目录。")]),s._v(" "),e("blockquote",[e("p",[s._v("在容器中的 "),e("code",[s._v("/home")]),s._v(" 下新建一个文件。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ec95646b1a4c /"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /home")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ec95646b1a4c home"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ec95646b1a4c home"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# touch test.java")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ec95646b1a4c home"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\ntest.java\n")])])]),e("blockquote",[e("p",[s._v("查看主机的 "),e("code",[s._v("ceshi")]),s._v(" 目录。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs home"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd ceshi")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs ceshi"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\ntest.java\n")])])]),e("p",[s._v("此时主机中的 "),e("code",[s._v("ceshi")]),s._v(" 目录下也有了这个文件。")]),s._v(" "),e("blockquote",[e("p",[s._v("关闭容器。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ec95646b1a4c home"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# exit")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n")])])]),e("blockquote",[e("p",[s._v("修改主机中 "),e("code",[s._v("/home/ceshi/test.java")]),s._v(" 文件的内容。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs ceshi"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim test.java")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 此处编辑文件过程省略")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs ceshi"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat test.java")]),s._v("\nhello sail\n")])])]),e("blockquote",[e("p",[s._v("重启容器。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker start ec95646b1a4cec95646b1a4c")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps")]),s._v("\nCONTAINER ID   IMAGE          COMMAND             CREATED          STATUS         PORTS           NAME\nSec95646b1a4c   centos         "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),s._v("         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" minutes ago   Up "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" seconds                            charming_cartwright\n")])])]),e("blockquote",[e("p",[s._v("查看 "),e("code",[s._v("/home")]),s._v(" 下的文件。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it ec95646b1a4c /bin/bash")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ec95646b1a4c /"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /home")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ec95646b1a4c home"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\ntest.java\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ec95646b1a4c home"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat test.java")]),s._v("\nhello sail\n")])])]),e("p",[s._v("此时容器中的文件也更改了。")]),s._v(" "),e("blockquote",[e("p",[s._v("由此可见，数据卷技术实现的是双向同步。")])]),s._v(" "),e("h3",{attrs:{id:"权限设置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#权限设置"}},[s._v("#")]),s._v(" 权限设置")]),s._v(" "),e("p",[s._v("在使用命令方式设置卷时，还可以指定权限，以此保证数据安全。")]),s._v(" "),e("blockquote",[e("p",[s._v("参数")])]),s._v(" "),e("ul",[e("li",[e("code",[s._v("ro")]),s._v("(readonly)：只读。")]),s._v(" "),e("li",[e("code",[s._v("rw")]),s._v("(readwrite)：可读可写。")])]),s._v(" "),e("blockquote",[e("p",[s._v("以数据卷只读权限启动镜像。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs mysql"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -it -v /home/qzs:/home:ro centos /bin/bash")]),s._v("\n")])])]),e("blockquote",[e("p",[s._v("新建文件测试。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@02ef70c94920 home"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# touch test.java")]),s._v("\ntouch: cannot "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'test.java'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" Read-only "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" system\n")])])]),e("p",[s._v("容器内部该目录是没有写入权限的。")]),s._v(" "),e("blockquote",[e("p",[s._v("以数据卷可读可写的权限启动镜像。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs mysql"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -it -v /home/qzs:/home:rw centos /bin/bash")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@48678e08f868 /"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /home")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@48678e08f868 home"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# touch test.java")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@48678e08f868 home"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\napache-tomcat-9.0.55.tar.gz  jdk-8u301-linux-x64.rpm  test.java\n")])])]),e("blockquote",[e("p",[s._v("新建文件测试。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs mysql"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -it -v /home/sail:/home:rw centos /bin/bash")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@48678e08f868 /"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /home")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@48678e08f868 home"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# touch test.java")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@48678e08f868 home"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\napache-tomcat-9.0.55.tar.gz  jdk-8u301-linux-x64.rpm  test.java\n")])])]),e("p",[s._v("容器内部该目录写入是没有问题的。")]),s._v(" "),e("blockquote",[e("p",[s._v("前面我们没有指定权限也可以写入，由此可见，数据卷默认是具有读写权限的。")])]),s._v(" "),e("h2",{attrs:{id:"具名挂载"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#具名挂载"}},[s._v("#")]),s._v(" 具名挂载")]),s._v(" "),e("blockquote",[e("p",[s._v("启动镜像时只定义主机卷名称，不指定挂载目录。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs mysql"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -it -v my-centos:/home centos /bin/bash")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@3cf74e9e6973 /"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n")])])]),e("blockquote",[e("p",[s._v("查看目前挂载的卷。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 Ctrl + P + Q 不退出容器的情况下回到主机目录。")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs mysql"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker volume ls")]),s._v("\nDRIVER    VOLUME NAME\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("     my-centos\n")])])]),e("blockquote",[e("p",[s._v("查看卷的详情。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs mysql"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker volume inspect my-centos")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CreatedAt"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2021-12-20T16:55:35+08:00"')]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Driver"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local"')]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Labels"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" null,\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mountpoint"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/lib/docker/volumes/my-centos/_data"')]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"my-centos"')]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Options"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" null,\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Scope"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local"')]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),e("p",[s._v("卷挂载在 "),e("code",[s._v("/var/lib/docker/volumes/卷名/_data")]),s._v(" 目录下。")]),s._v(" "),e("p",[s._v("在没有指定主机挂载目录的情况下，会默认挂载到该目录。")]),s._v(" "),e("blockquote",[e("p",[s._v("由于指定了卷名，所以这种方式称为具名挂载。")])]),s._v(" "),e("h2",{attrs:{id:"匿名挂载"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#匿名挂载"}},[s._v("#")]),s._v(" 匿名挂载")]),s._v(" "),e("blockquote",[e("p",[s._v("启动镜像时只指定容器目录。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs mysql"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -it -v /home centos /bin/bash")]),s._v("\n")])])]),e("blockquote",[e("p",[s._v("查看目前挂载的卷。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs mysql"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker volume ls")]),s._v("\nDRIVER    VOLUME NAME\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("     159830cf55550c9a39e845c1d96aa04cc762005bc0c64d15d5066834b47df940\n")])])]),e("blockquote",[e("p",[s._v("查看卷的详情。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs mysql"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker volume inspect 159830cf55550c9a39e845c1d96aa04cc762005bc0c64d15d5066834b47df940")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CreatedAt"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2021-12-20T17:05:23+08:00"')]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Driver"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local"')]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Labels"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" null,\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mountpoint"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/lib/docker/volumes/159830cf55550c9a39e845c1d96aa04cc762005bc0c64d15d5066834b47df940/_data"')]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"159830cf55550c9a39e845c1d96aa04cc762005bc0c64d15d5066834b47df940"')]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Options"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" null,\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Scope"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local"')]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),e("p",[s._v("卷也是挂载在 "),e("code",[s._v("/var/lib/docker/volumes/xxx/_data")]),s._v(" 目录下。")]),s._v(" "),e("p",[s._v("在没有指定主机挂载目录的情况下，会默认挂载到该目录。")]),s._v(" "),e("blockquote",[e("p",[s._v("由于没有指定卷名，所以这种方式称为匿名挂载。")])]),s._v(" "),e("p",[s._v("只有指定主机目录的情况下会挂载到指定目录，否则都会挂载到默认目录。")]),s._v(" "),e("h2",{attrs:{id:"实战"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#实战"}},[s._v("#")]),s._v(" 实战")]),s._v(" "),e("h3",{attrs:{id:"mysql数据同步"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mysql数据同步"}},[s._v("#")]),s._v(" mysql数据同步")]),s._v(" "),e("p",[s._v("数据库中的数据极为重要，必须同步到主机，否则将会有非常大的数据丢失风险。")]),s._v(" "),e("p",[s._v("这里以 mysql 镜像为例演示数据同步的过程。")]),s._v(" "),e("blockquote",[e("p",[s._v("启动 mysql 镜像。")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("[root@qzs ~]# docker run -d -p 3310:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysql01 mysql:5.7\nUnable to find image 'mysql:5.7' locally\n5.7: Pulling from library/mysql\nffbb094f4f9e: Pull complete \ndf186527fc46: Pull complete \nfa362a6aa7bd: Pull complete \n5af7cb1a200e: Pull complete \n949da226cc6d: Pull complete \nbce007079ee9: Pull complete \neab9f076e5a3: Pull complete \nc7b24c3f27af: Pull complete \n6fc26ff6705a: Pull complete \nbec5cdb5e7f7: Pull complete \n6c1cb25f7525: Pull complete \nDigest: sha256:d1cc87a3bd5dc07defc837bc9084f748a130606ff41923f46dec1986e0dc828d\nStatus: Downloaded newer image for mysql:5.7\na016e564d977550e475474556cfd033fb1c731002381bc9f9544c63fccb7f60c\n")])])]),e("p",[s._v("其中 "),e("code",[s._v("-e")]),s._v(" 为环境配置。安装启动 mysql 需要配置密码。")]),s._v(" "),e("blockquote",[e("p",[s._v("使用"),e("code",[s._v("docker inspect")]),s._v("查看挂载情况。")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(461),alt:"img"}})]),s._v(" "),e("p",[s._v("已经生成了两个目录的挂载。")]),s._v(" "),e("blockquote",[e("p",[s._v("查看主机同步的目录。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /home")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs home"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nadmin  ceshi  f2  f3  mysql  sail  test.java\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs home"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd mysql")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs mysql"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nconf  data\n")])])]),e("p",[s._v("主机已经同步了容器挂载的目录。")]),s._v(" "),e("h1",{attrs:{id:"dockerfile"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[s._v("#")]),s._v(" DockerFile")]),s._v(" "),e("h2",{attrs:{id:"简介-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#简介-2"}},[s._v("#")]),s._v(" 简介")]),s._v(" "),e("p",[e("img",{attrs:{src:a(462),alt:"img"}})]),s._v(" "),e("p",[s._v("Dockerfile 是用来构建 Docker 镜像的文件，可以理解为"),e("strong",[s._v("命令参数脚本")]),s._v("。")]),s._v(" "),e("p",[s._v("Dockerfile 是面向开发的，想要打包项目，就要编写 Dockerfile 文件。")]),s._v(" "),e("blockquote",[e("p",[s._v("由于 Docker 的流行，Docker 镜像逐渐替代 "),e("strong",[s._v("jar")]),s._v(" 或者 "),e("strong",[s._v("war")]),s._v(" 成为企业的交付标准。")])]),s._v(" "),e("h2",{attrs:{id:"官方-dockerfile"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#官方-dockerfile"}},[s._v("#")]),s._v(" 官方 Dockerfile")]),s._v(" "),e("blockquote",[e("p",[s._v("首先看一下官方的 Dockerfile。")])]),s._v(" "),e("p",[s._v("这里以 centos 的镜像为例。")]),s._v(" "),e("blockquote",[e("p",[s._v("在 "),e("a",{attrs:{href:"https://hub.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker Hub"),e("OutboundLink")],1),s._v(" 搜索 centos 镜像，选择官方镜像。")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(463),alt:"img"}})]),s._v(" "),e("blockquote",[e("p",[s._v("点击 "),e("strong",[s._v("The CentOS Project")]),s._v(" 。")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(464),alt:"img"}})]),s._v(" "),e("blockquote",[e("p",[s._v("选择版本分支。这里以 "),e("strong",[s._v("CentOS-7.6.1810")]),s._v(" 为例。")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(465),alt:"img"}})]),s._v(" "),e("blockquote",[e("p",[s._v("查看 Dockerfile。")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(466),alt:"img"}})]),s._v(" "),e("p",[e("img",{attrs:{src:a(467),alt:"img"}})]),s._v(" "),e("blockquote",[e("p",[s._v("可以看出官方的 Dockerfile 是很简洁的，这就是 Docker 极致精简的原因。")])]),s._v(" "),e("p",[s._v("不过，官方镜像都是基础包，很多功能是没有的，比如 centos 的官方镜像是没有 "),e("code",[s._v("vim")]),s._v(" 命令的。")]),s._v(" "),e("p",[s._v("像这种基础命令比较常用，如果想要使用可以在容器内安装，但这样很不方便，因为每个新启动的容器都要安装。")]),s._v(" "),e("p",[s._v("我们通常会选择自己搭建镜像，这就要用到 Dockerfile 了。")]),s._v(" "),e("h2",{attrs:{id:"命令-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#命令-2"}},[s._v("#")]),s._v(" 命令")]),s._v(" "),e("p",[s._v("以上面的 centos 官方镜像的 Dockerfile 为例。")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("FROM scratch\nADD centos-7-docker.tar.xz /\nLABEL org.label-schema.schema-version"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1.0"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    org.label-schema.name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CentOS Base Image"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    org.label-schema.vendor"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CentOS"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    org.label-schema.license"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"GPLv2"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    org.label-schema.build-date"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"20181204"')]),s._v("\nCMD "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),e("p",[s._v("Docker Hub 中 99% 的镜像都是从"),e("code",[s._v("FROM scratch")]),s._v(" 开始的。")]),s._v(" "),e("blockquote",[e("p",[s._v("规则")])]),s._v(" "),e("ul",[e("li",[s._v("每个指令都必须是大写字母。")]),s._v(" "),e("li",[s._v("按照从上到下顺序执行。")]),s._v(" "),e("li",[e("strong",[s._v("#")]),s._v(" 表示注释。")]),s._v(" "),e("li",[s._v("每一条指令都会创建一个新的镜像层。")])]),s._v(" "),e("blockquote",[e("p",[s._v("解释")])]),s._v(" "),e("ul",[e("li",[e("code",[s._v("FROM")]),s._v("：基础镜像，比如 centos。")]),s._v(" "),e("li",[e("code",[s._v("MAINTAINER")]),s._v("：镜像是谁写的。建议以此格式："),e("code",[s._v("姓名<邮箱>")]),s._v("。")]),s._v(" "),e("li",[e("code",[s._v("RUN")]),s._v("：镜像构建时需要运行的命令。")]),s._v(" "),e("li",[e("code",[s._v("ADD")]),s._v("：添加，比如添加一个 tomcat 压缩包。")]),s._v(" "),e("li",[e("code",[s._v("WORKDIR")]),s._v("：镜像的工作目录。")]),s._v(" "),e("li",[e("code",[s._v("VOLUME")]),s._v("：挂载的目录。")]),s._v(" "),e("li",[e("code",[s._v("EXPOSE")]),s._v("：指定暴露端口，跟 -p 一个道理。")]),s._v(" "),e("li",[e("code",[s._v("RUN")]),s._v("：最终要运行的。")]),s._v(" "),e("li",[e("code",[s._v("CMD")]),s._v("：指定这个容器启动的时候要运行的命令，只有最后一个会生效，而且可被替代。")]),s._v(" "),e("li",[e("code",[s._v("ENTRYPOINT")]),s._v("：指定这个容器启动的时候要运行的命令，可以追加命令。")]),s._v(" "),e("li",[e("code",[s._v("ONBUILD")]),s._v("：当构建一个被继承Dockerfile 这个时候运行ONBUILD指定，触发指令。")]),s._v(" "),e("li",[e("code",[s._v("COPY")]),s._v("：将文件拷贝到镜像中。")]),s._v(" "),e("li",[e("code",[s._v("ENV")]),s._v("：构建的时候设置环境变量。")])]),s._v(" "),e("h3",{attrs:{id:"构建镜像"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#构建镜像"}},[s._v("#")]),s._v(" 构建镜像")]),s._v(" "),e("h4",{attrs:{id:"docker-build"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-build"}},[s._v("#")]),s._v(" docker build")]),s._v(" "),e("p",[s._v("Dockerfile 编写好后，需要使用 "),e("code",[s._v("docker build")]),s._v(" 命令运行。")]),s._v(" "),e("blockquote",[e("p",[s._v("语法")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("docker build [参数] 路径 | 网络地址 | -\n")])])]),e("blockquote",[e("p",[s._v("参数")])]),s._v(" "),e("ul",[e("li",[e("code",[s._v("-f")]),s._v("：指定要使用的Dockerfile路径。")]),s._v(" "),e("li",[e("code",[s._v("-t")]),s._v("：镜像的名字及标签，通常 "),e("strong",[s._v("name:tag")]),s._v(" 或者 "),e("strong",[s._v("name")]),s._v(" 格式；可以在一次构建中为一个镜像设置多个标签。")]),s._v(" "),e("li",[e("code",[s._v("-m")]),s._v("：设置内存最大值。")])]),s._v(" "),e("blockquote",[e("p",[s._v("Docker 守护进程执行 Dockerfile 中的指令前，首先会对 Dockerfile 进行语法检查，有语法错误时会返回报错信息。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("Error response from daemon: Unknown instruction: RUNCMD\n")])])]),e("h3",{attrs:{id:"查看构建记录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看构建记录"}},[s._v("#")]),s._v(" 查看构建记录")]),s._v(" "),e("h4",{attrs:{id:"docker-history"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-history"}},[s._v("#")]),s._v(" docker history")]),s._v(" "),e("blockquote",[e("p",[s._v("语法")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("docker history 镜像\n")])])]),e("h3",{attrs:{id:"cmd-与-entrypoint-区别"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cmd-与-entrypoint-区别"}},[s._v("#")]),s._v(" CMD 与 ENTRYPOINT 区别")]),s._v(" "),e("h4",{attrs:{id:"cmd-命令演示"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cmd-命令演示"}},[s._v("#")]),s._v(" CMD 命令演示")]),s._v(" "),e("blockquote",[e("p",[s._v("编写 Dockerfile")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs dockerfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim Dockerfile-cmd-test")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs dockerfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat Dockerfile-cmd-test ")]),s._v("\nFROM centos\nCMD "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ls"')]),s._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-a"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),e("blockquote",[e("p",[s._v("构建镜像")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs dockerfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker build -f Dockerfile-cmd-test -t cmdtest .")]),s._v("\nSending build context to Docker daemon  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".048kB\nStep "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/2 "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" FROM centos\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 5d0da3dc9764\nStep "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/2 "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" CMD "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ls"')]),s._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-a"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" 0a743e929fff\nRemoving intermediate container 0a743e929fff\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 1683c0790d49\nSuccessfully built 1683c0790d49\nSuccessfully tagged cmdtest:latest\n")])])]),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs dockerfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images")]),s._v("\nREPOSITORY        TAG       IMAGE ID       CREATED          SIZE\ncmdtest           latest    1683c0790d49   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" minutes ago   231MB\n")])])]),e("blockquote",[e("p",[s._v("运行镜像")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs dockerfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run cmdtest")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n.dockerenv\nbin\ndev\netc\nhome\nlib\nlib64\nlost+found\nmedia\nmnt\nopt\nproc\nroot\nrun\nsbin\nsrv\nsys\ntmp\nusr\nvar\n")])])]),e("p",[s._v("此时 Dockerfile 中编写的命令生效了。")]),s._v(" "),e("blockquote",[e("p",[s._v("追加 "),e("code",[s._v("-l")]),s._v(" 命令")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs dockerfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run cmdtest -l")]),s._v("\ndocker: Error response from daemon: OCI runtime create failed: container_linux.go:380: starting container process caused: exec: "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-l"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" executable "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" not found "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" unknown.\nERRO"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("0000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" error waiting "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" container: context canceled\n")])])]),e("p",[s._v("没有达到预期的 "),e("code",[s._v("ls -al")]),s._v(" 命令。")]),s._v(" "),e("blockquote",[e("p",[e("code",[s._v("CMD")]),s._v(" 是"),e("strong",[s._v("替换")]),s._v("的方式， "),e("code",[s._v("-l")]),s._v(" 不是命令，所以报错。")])]),s._v(" "),e("h4",{attrs:{id:"entrypoint-命令演示"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#entrypoint-命令演示"}},[s._v("#")]),s._v(" ENTRYPOINT 命令演示")]),s._v(" "),e("blockquote",[e("p",[s._v("编写 Dockerfile")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('[root@qzs dockerfile]# vim Dockerfile-entrypoint-test\n[root@qzs dockerfile]# cat Dockerfile-entrypoint-test \nFROM centos\nENTRYPOINT ["ls","-a"]\n')])])]),e("blockquote",[e("p",[s._v("构建镜像")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs dockerfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker build -f Dockerfile-entrypoint-test -t entrypoint-test .")]),s._v("\nSending build context to Docker daemon  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".072kB\nStep "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/2 "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" FROM centos\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 5d0da3dc9764\nStep "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/2 "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ENTRYPOINT "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ls"')]),s._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-a"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" a02d55ae0a00\nRemoving intermediate container a02d55ae0a00\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 795973a0ed43\nSuccessfully built 795973a0ed43\nSuccessfully tagged entrypoint-test:latest\n")])])]),e("blockquote",[e("p",[s._v("运行镜像")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs dockerfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run entrypoint-test")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n.dockerenv\nbin\ndev\netc\nhome\nlib\nlib64\nlost+found\nmedia\nmnt\nopt\nproc\nroot\nrun\nsbin\nsrv\nsys\ntmp\nusr\nvar\n")])])]),e("p",[s._v("此时 Dockerfile 中编写的命令也生效了。")]),s._v(" "),e("blockquote",[e("p",[s._v("追加 "),e("code",[s._v("-l")]),s._v(" 命令")])]),s._v(" "),e("div",{staticClass:"language-sehll extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("[root@qzs dockerfile]# docker run entrypoint-test -l\ntotal 56\ndrwxr-xr-x   1 root root 4096 Dec 23 06:46 .\ndrwxr-xr-x   1 root root 4096 Dec 23 06:46 ..\n-rwxr-xr-x   1 root root    0 Dec 23 06:46 .dockerenv\nlrwxrwxrwx   1 root root    7 Nov  3  2020 bin -> usr/bin\ndrwxr-xr-x   5 root root  340 Dec 23 06:46 dev\ndrwxr-xr-x   1 root root 4096 Dec 23 06:46 etc\ndrwxr-xr-x   2 root root 4096 Nov  3  2020 home\nlrwxrwxrwx   1 root root    7 Nov  3  2020 lib -> usr/lib\nlrwxrwxrwx   1 root root    9 Nov  3  2020 lib64 -> usr/lib64\ndrwx------   2 root root 4096 Sep 15 14:17 lost+found\ndrwxr-xr-x   2 root root 4096 Nov  3  2020 media\ndrwxr-xr-x   2 root root 4096 Nov  3  2020 mnt\ndrwxr-xr-x   2 root root 4096 Nov  3  2020 opt\ndr-xr-xr-x 106 root root    0 Dec 23 06:46 proc\ndr-xr-x---   2 root root 4096 Sep 15 14:17 root\ndrwxr-xr-x  11 root root 4096 Sep 15 14:17 run\nlrwxrwxrwx   1 root root    8 Nov  3  2020 sbin -> usr/sbin\ndrwxr-xr-x   2 root root 4096 Nov  3  2020 srv\ndr-xr-xr-x  13 root root    0 Oct 31 15:00 sys\ndrwxrwxrwt   7 root root 4096 Sep 15 14:17 tmp\ndrwxr-xr-x  12 root root 4096 Sep 15 14:17 usr\ndrwxr-xr-x  20 root root 4096 Sep 15 14:17 var\n")])])]),e("p",[s._v("运行了预期的 "),e("code",[s._v("ls -al")]),s._v(" 命令。")]),s._v(" "),e("blockquote",[e("p",[e("code",[s._v("ENTRYPOINT")]),s._v(" 是"),e("strong",[s._v("追加")]),s._v("的方式。")])]),s._v(" "),e("p",[s._v("Docker 中许多命令都十分相似，我们需要了解他们的区别，最好的方式就是这样对比测试。")]),s._v(" "),e("h2",{attrs:{id:"实战-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#实战-2"}},[s._v("#")]),s._v(" 实战")]),s._v(" "),e("h3",{attrs:{id:"创建包含vim命令的centos镜像"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建包含vim命令的centos镜像"}},[s._v("#")]),s._v(" 创建包含vim命令的centos镜像")]),s._v(" "),e("blockquote",[e("p",[s._v("编写 Dockerfile")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs dockerfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim Dockerfile-centos-test ")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs dockerfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat Dockerfile-centos-test ")]),s._v("\nFROM centos\nMAINTAINER qzs"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("283408112")]),s._v("@qq.com"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nENV MYPATH /usr/local\nWORKDIR "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MYPATH")]),s._v("\nRUN yum -y "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v("\nRUN yum -y "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" net-tools\nEXPOSE "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("81")]),s._v("\nCMD "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MYPATH")]),s._v("\nCMD "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"---end---"')]),s._v("\nCMD "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),e("blockquote",[e("p",[s._v("构建镜像")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs dockerfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker build -f Dockerfile-centos-test -t centos-test .")]),s._v("\nSending build context to Docker daemon  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(".632kB\nStep "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/10 "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" FROM centos\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 5d0da3dc9764\nStep "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/10 "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" MAINTAINER sail"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("yifansailing@163.com"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" 8b7340768878\nRemoving intermediate container 8b7340768878\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 9616888f3b10\nStep "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("/10 "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ENV MYPATH /usr/local\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" 2c73446a56ff\nRemoving intermediate container 2c73446a56ff\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" be89377d4c2c\nStep "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("/10 "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" WORKDIR "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MYPATH")]),s._v("\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" db113c4f7cb2\nRemoving intermediate container db113c4f7cb2\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" fb41ece5d944\nStep "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("/10 "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" RUN yum -y "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v("\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" eccee60c0389\nCentOS Linux "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" - AppStream                       "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" MB/s "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8.4")]),s._v(" MB     00:00    \nCentOS Linux "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" - BaseOS                         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.7")]),s._v(" MB/s "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.6")]),s._v(" MB     00:02    \nCentOS Linux "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" - Extras                          "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" kB/s "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" kB     00:00    \nLast metadata expiration check: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":00:01 ago on Sat Dec "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" 05:09:40 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v(".\nDependencies resolved.\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v("\n Package             Arch        Version                   Repository      Size\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v("\nInstalling:\n vim-enhanced        x86_64      "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(":8.0.1763-16.el8         appstream      "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.4")]),s._v(" M\nInstalling dependencies:\n gpm-libs            x86_64      "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.20")]),s._v(".7-17.el8             appstream       "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("39")]),s._v(" k\n vim-common          x86_64      "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(":8.0.1763-16.el8         appstream      "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.3")]),s._v(" M\n vim-filesystem      noarch      "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(":8.0.1763-16.el8         appstream       "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("49")]),s._v(" k\n "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v("               x86_64      "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.21")]),s._v("-16.el8               baseos          "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("49")]),s._v(" k\nTransaction Summary\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v("\nInstall  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" Packages\nTotal download size: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.8")]),s._v(" M\nInstalled size: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(" M\nDownloading Packages:\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/5"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": gpm-libs-1.20.7-17.el8.x86_64.rpm        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("582")]),s._v(" kB/s "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("39")]),s._v(" kB     00:00    \n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/5"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": vim-filesystem-8.0.1763-16.el8.noarch.rp "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.2")]),s._v(" MB/s "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("49")]),s._v(" kB     00:00    \n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("/5"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": vim-common-8.0.1763-16.el8.x86_64.rpm     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("40")]),s._v(" MB/s "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.3")]),s._v(" MB     00:00    \n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("/5"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": vim-enhanced-8.0.1763-16.el8.x86_64.rpm  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.1")]),s._v(" MB/s "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.4")]),s._v(" MB     00:00    \n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("/5"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": which-2.21-16.el8.x86_64.rpm             "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("252")]),s._v(" kB/s "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("49")]),s._v(" kB     00:00    \n--------------------------------------------------------------------------------\nTotal                                           "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.4")]),s._v(" MB/s "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.8")]),s._v(" MB     00:01     \nwarning: /var/cache/dnf/appstream-02e86d1c976ab532/packages/gpm-libs-1.20.7-17.el8.x86_64.rpm: Header V3 RSA/SHA256 Signature, key ID 8483c65d: NOKEY\nCentOS Linux "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" - AppStream                      "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.6")]),s._v(" MB/s "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.6")]),s._v(" kB     00:00    \nImporting GPG key 0x8483C65D:\n Userid     "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CentOS (CentOS Official Signing Key) <security@centos.org>"')]),s._v("\n Fingerprint: 99DB 70FA E1D7 CE22 7FB6 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4882")]),s._v(" 05B5 55B3 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8483")]),s._v(" C65D\n From       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" /etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial\nKey imported successfully\nRunning transaction check\nTransaction check succeeded.\nRunning transaction "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\nTransaction "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" succeeded.\nRunning transaction\n  Preparing        "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v("                                                        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1 \n  Installing       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" which-2.21-16.el8.x86_64                               "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/5 \n  Installing       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" vim-filesystem-2:8.0.1763-16.el8.noarch                "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/5 \n  Installing       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" vim-common-2:8.0.1763-16.el8.x86_64                    "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("/5 \n  Installing       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" gpm-libs-1.20.7-17.el8.x86_64                          "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("/5 \n  Running scriptlet: gpm-libs-1.20.7-17.el8.x86_64                          "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("/5 \n  Installing       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" vim-enhanced-2:8.0.1763-16.el8.x86_64                  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("/5 \n  Running scriptlet: vim-enhanced-2:8.0.1763-16.el8.x86_64                  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("/5 \n  Running scriptlet: vim-common-2:8.0.1763-16.el8.x86_64                    "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("/5 \n  Verifying        "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" gpm-libs-1.20.7-17.el8.x86_64                          "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/5 \n  Verifying        "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" vim-common-2:8.0.1763-16.el8.x86_64                    "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/5 \n  Verifying        "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" vim-enhanced-2:8.0.1763-16.el8.x86_64                  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("/5 \n  Verifying        "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" vim-filesystem-2:8.0.1763-16.el8.noarch                "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("/5 \n  Verifying        "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" which-2.21-16.el8.x86_64                               "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("/5 \nInstalled:\n  gpm-libs-1.20.7-17.el8.x86_64         vim-common-2:8.0.1763-16.el8.x86_64    \n  vim-enhanced-2:8.0.1763-16.el8.x86_64 vim-filesystem-2:8.0.1763-16.el8.noarch\n  which-2.21-16.el8.x86_64             \nComplete"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nRemoving intermediate container eccee60c0389\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 9f54f48660ac\nStep "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("/10 "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" RUN yum -y "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" net-tools\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" 6caa7361b001\nLast metadata expiration check: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":00:08 ago on Sat Dec "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" 05:09:40 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v(".\nDependencies resolved.\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v("\n Package         Architecture Version                        Repository    Size\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v("\nInstalling:\n net-tools       x86_64       "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.0")]),s._v("-0.52.20160912git.el8       baseos       "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("322")]),s._v(" k\nTransaction Summary\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v("\nInstall  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" Package\nTotal download size: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("322")]),s._v(" k\nInstalled size: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("942")]),s._v(" k\nDownloading Packages:\nnet-tools-2.0-0.52.20160912git.el8.x86_64.rpm   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v(" MB/s "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("322")]),s._v(" kB     00:00    \n--------------------------------------------------------------------------------\nTotal                                           "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("449")]),s._v(" kB/s "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("322")]),s._v(" kB     00:00     \nRunning transaction check\nTransaction check succeeded.\nRunning transaction "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\nTransaction "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" succeeded.\nRunning transaction\n  Preparing        "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v("                                                        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1 \n  Installing       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" net-tools-2.0-0.52.20160912git.el8.x86_64              "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1 \n  Running scriptlet: net-tools-2.0-0.52.20160912git.el8.x86_64              "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1 \n  Verifying        "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" net-tools-2.0-0.52.20160912git.el8.x86_64              "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1 \nInstalled:\n  net-tools-2.0-0.52.20160912git.el8.x86_64                                     \nComplete"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nRemoving intermediate container 6caa7361b001\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" a9431f90fd3f\nStep "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("/10 "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" EXPOSE "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("81")]),s._v("\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" ad67fa23940a\nRemoving intermediate container ad67fa23940a\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" b5bd21416741\nStep "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("/10 "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" CMD "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MYPATH")]),s._v("\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" fb1d08538689\nRemoving intermediate container fb1d08538689\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 5c5def0bbb85\nStep "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("/10 "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" CMD "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"---end---"')]),s._v("\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" a9d955b6b389\nRemoving intermediate container a9d955b6b389\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ad95558eb658\nStep "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("/10 "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" CMD "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" 190651202e7b\nRemoving intermediate container 190651202e7b\n ---"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" d58be7785771\nSuccessfully built d58be7785771\nSuccessfully tagged centos-test:latest\n")])])]),e("blockquote",[e("p",[s._v("查看构建的镜像")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs dockerfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images")]),s._v("\nREPOSITORY        TAG       IMAGE ID       CREATED              SIZE\ncentos-test       latest    d58be7785771   About a minute ago   323MB\n")])])]),e("blockquote",[e("p",[s._v("查看本地镜像的构建记录")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('[root@qzs dockerfile]# docker history centos-test\nIMAGE          CREATED         CREATED BY                                      SIZE      COMMENT\nd58be7785771   5 minutes ago   /bin/sh -c #(nop)  CMD ["/bin/bash"]            0B        \nad95558eb658   5 minutes ago   /bin/sh -c #(nop)  CMD ["/bin/sh" "-c" "echo…   0B        \n5c5def0bbb85   5 minutes ago   /bin/sh -c #(nop)  CMD ["/bin/sh" "-c" "echo…   0B        \nb5bd21416741   5 minutes ago   /bin/sh -c #(nop)  EXPOSE 81                    0B        \na9431f90fd3f   5 minutes ago   /bin/sh -c yum -y install net-tools             27.3MB    \n9f54f48660ac   5 minutes ago   /bin/sh -c yum -y install vim                   64.8MB    \nfb41ece5d944   5 minutes ago   /bin/sh -c #(nop) WORKDIR /usr/local            0B        \nbe89377d4c2c   5 minutes ago   /bin/sh -c #(nop)  ENV MYPATH=/usr/local        0B        \n9616888f3b10   5 minutes ago   /bin/sh -c #(nop)  MAINTAINER sail<yifansail…   0B        \n5d0da3dc9764   3 months ago    /bin/sh -c #(nop)  CMD ["/bin/bash"]            0B        \n<missing>      3 months ago    /bin/sh -c #(nop)  LABEL org.label-schema.sc…   0B        \n<missing>      3 months ago    /bin/sh -c #(nop) ADD file:805cb5e15fb6e0bb0…   231MB\n')])])]),e("blockquote",[e("p",[s._v("运行测试")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -it centos-test")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@530551bc2162 local"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pwd")]),s._v("\n/usr/local\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@530551bc2162 local"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim test.java")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@530551bc2162 local"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n")])])]),e("p",[s._v("默认的工作目录正是 Dockerfile 中设置的 "),e("code",[s._v("/usr/local")]),s._v(" ，且可以使用 "),e("code",[s._v("vim")]),s._v(" 命令了。")]),s._v(" "),e("h3",{attrs:{id:"自定义tomcat环境镜像"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#自定义tomcat环境镜像"}},[s._v("#")]),s._v(" 自定义tomcat环境镜像")]),s._v(" "),e("blockquote",[e("p",[s._v("编写 Dockerfile")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("FROM centos\nMAINTAINER qzs"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("283408112")]),s._v("@qq.com"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nCOPY readme.txt /usr/local/readme.txt\nENV MYPATH /usr/local/\nWORKDIR "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MYPATH")]),s._v("\nADD jdk-8u301-linux-x64.tar.gz "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MYPATH")]),s._v("\nADD apache-tomcat-9.0.55.tar.gz "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MYPATH")]),s._v("\nRUN yum -y "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v("\nENV JAVA_HOME "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MYPATH")]),s._v("/jdk1.8.0_301-amd64\nENV CLASSPATH "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/lib/\nENV CATALINA_HOME "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MYPATH")]),s._v("/apache-tomcat-9.0.55\nENV CATALINA_BASH "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MYPATH")]),s._v("/apache-tomcat-9.0.55\nENV "),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/bin:"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CATALINA_HOME")]),s._v("/bin:"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CATALINA_HOME")]),s._v("/lib\nEXPOSE "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("\nCMD "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CATALINA_HOME")]),s._v("/bin/startup.sh "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" -F "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CATALINA_HOME")]),s._v("/logs/catalina.out\n")])])]),e("p",[s._v("其中的 "),e("strong",[s._v("readme.txt")]),s._v(" 一般作为镜像说明文件，可以在里面编写镜像的信息。")]),s._v(" "),e("blockquote",[e("p",[s._v("构建镜像")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('[root@qzs tomcat]# docker build -t tomcat-test .\nSending build context to Docker daemon  157.1MB\nStep 1/15 : FROM centos\n ---\x3e 5d0da3dc9764\nStep 2/15 : MAINTAINER sail<yifansailing@163.com>\n ---\x3e Using cache\n ---\x3e 9616888f3b10\nStep 3/15 : COPY readme.txt /usr/local/readme.txt\n ---\x3e da792df641f8\nStep 4/15 : ENV MYPATH /usr/local/\n ---\x3e Running in e4a5b13decd7\nRemoving intermediate container e4a5b13decd7\n ---\x3e 7b1e6970b4b3\nStep 5/15 : WORKDIR $MYPATH\n ---\x3e Running in 835dabd080dd\nRemoving intermediate container 835dabd080dd\n ---\x3e 7be17b1556ee\nStep 6/15 : ADD jdk-8u301-linux-x64.tar.gz $MYPATH\n ---\x3e 480721043fda\nStep 7/15 : ADD apache-tomcat-9.0.55.tar.gz $MYPATH\n ---\x3e c7bfa13bfcd1\nStep 8/15 : RUN yum -y install vim\n ---\x3e Running in 85532523d784\nCentOS Linux 8 - AppStream                      9.0 MB/s | 8.4 MB     00:00    \nCentOS Linux 8 - BaseOS                         5.6 MB/s | 3.6 MB     00:00    \nCentOS Linux 8 - Extras                          20 kB/s |  10 kB     00:00    \nDependencies resolved.\n================================================================================\n Package             Arch        Version                   Repository      Size\n================================================================================\nInstalling:\n vim-enhanced        x86_64      2:8.0.1763-16.el8         appstream      1.4 M\nInstalling dependencies:\n gpm-libs            x86_64      1.20.7-17.el8             appstream       39 k\n vim-common          x86_64      2:8.0.1763-16.el8         appstream      6.3 M\n vim-filesystem      noarch      2:8.0.1763-16.el8         appstream       49 k\n which               x86_64      2.21-16.el8               baseos          49 k\nTransaction Summary\n================================================================================\nInstall  5 Packages\nTotal download size: 7.8 M\nInstalled size: 30 M\nDownloading Packages:\n(1/5): gpm-libs-1.20.7-17.el8.x86_64.rpm        973 kB/s |  39 kB     00:00    \n(2/5): vim-filesystem-8.0.1763-16.el8.noarch.rp 726 kB/s |  49 kB     00:00    \n(3/5): vim-enhanced-8.0.1763-16.el8.x86_64.rpm   10 MB/s | 1.4 MB     00:00    \n(4/5): which-2.21-16.el8.x86_64.rpm             901 kB/s |  49 kB     00:00    \n(5/5): vim-common-8.0.1763-16.el8.x86_64.rpm     27 MB/s | 6.3 MB     00:00    \n--------------------------------------------------------------------------------\nTotal                                           6.6 MB/s | 7.8 MB     00:01     \nwarning: /var/cache/dnf/appstream-02e86d1c976ab532/packages/gpm-libs-1.20.7-17.el8.x86_64.rpm: Header V3 RSA/SHA256 Signature, key ID 8483c65d: NOKEY\nCentOS Linux 8 - AppStream                      1.6 MB/s | 1.6 kB     00:00    \nImporting GPG key 0x8483C65D:\n Userid     : "CentOS (CentOS Official Signing Key) <security@centos.org>"\n Fingerprint: 99DB 70FA E1D7 CE22 7FB6 4882 05B5 55B3 8483 C65D\n From       : /etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial\nKey imported successfully\nRunning transaction check\nTransaction check succeeded.\nRunning transaction test\nTransaction test succeeded.\nRunning transaction\n  Preparing        :                                                        1/1 \n  Installing       : which-2.21-16.el8.x86_64                               1/5 \n  Installing       : vim-filesystem-2:8.0.1763-16.el8.noarch                2/5 \n  Installing       : vim-common-2:8.0.1763-16.el8.x86_64                    3/5 \n  Installing       : gpm-libs-1.20.7-17.el8.x86_64                          4/5 \n  Running scriptlet: gpm-libs-1.20.7-17.el8.x86_64                          4/5 \n  Installing       : vim-enhanced-2:8.0.1763-16.el8.x86_64                  5/5 \n  Running scriptlet: vim-enhanced-2:8.0.1763-16.el8.x86_64                  5/5 \n  Running scriptlet: vim-common-2:8.0.1763-16.el8.x86_64                    5/5 \n  Verifying        : gpm-libs-1.20.7-17.el8.x86_64                          1/5 \n  Verifying        : vim-common-2:8.0.1763-16.el8.x86_64                    2/5 \n  Verifying        : vim-enhanced-2:8.0.1763-16.el8.x86_64                  3/5 \n  Verifying        : vim-filesystem-2:8.0.1763-16.el8.noarch                4/5 \n  Verifying        : which-2.21-16.el8.x86_64                               5/5 \nInstalled:\n  gpm-libs-1.20.7-17.el8.x86_64         vim-common-2:8.0.1763-16.el8.x86_64    \n  vim-enhanced-2:8.0.1763-16.el8.x86_64 vim-filesystem-2:8.0.1763-16.el8.noarch\n  which-2.21-16.el8.x86_64             \nComplete!\nRemoving intermediate container 85532523d784\n ---\x3e e091ece0364d\nStep 9/15 : ENV JAVA_HOME $MYPATH/jdk1.8.0_301-amd64\n ---\x3e Running in 473066cf57f4\nRemoving intermediate container 473066cf57f4\n ---\x3e 0a8963a2c1ab\nStep 10/15 : ENV CLASSPATH $JAVA_HOME/lib/\n ---\x3e Running in 78a2cb9b06cd\nRemoving intermediate container 78a2cb9b06cd\n ---\x3e 3dd34a2857b4\nStep 11/15 : ENV CATALINA_HOME $MYPATH/apache-tomcat-9.0.55\n ---\x3e Running in 4ca540479e3d\nRemoving intermediate container 4ca540479e3d\n ---\x3e fa38f4581510\nStep 12/15 : ENV CATALINA_BASH $MYPATH/apache-tomcat-9.0.55\n ---\x3e Running in 31dc5b38478c\nRemoving intermediate container 31dc5b38478c\n ---\x3e 8ae919106bf6\nStep 13/15 : ENV PATH $PATH:$JAVA_HOME/bin:$CATALINA_HOME/bin:$CATALINA_HOME/lib\n ---\x3e Running in d3fe1f81fab7\nRemoving intermediate container d3fe1f81fab7\n ---\x3e dd8b07b2adfd\nStep 14/15 : EXPOSE 8080\n ---\x3e Running in 1f1601f2dcc2\nRemoving intermediate container 1f1601f2dcc2\n ---\x3e 9078648b7a2e\nStep 15/15 : CMD $CATALINA_HOME/bin/startup.sh && tail -F $CATALINA_HOME/logs/catalina.out\n ---\x3e Running in 6a3b2aefaf44\nRemoving intermediate container 6a3b2aefaf44\n ---\x3e 23a538c107a0\nSuccessfully built 23a538c107a0\nSuccessfully tagged tomcat-test:latest\n')])])]),e("blockquote",[e("p",[s._v("查看镜像")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs tomcat"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images")]),s._v("\nREPOSITORY        TAG       IMAGE ID       CREATED          SIZE\ntomcat-test       latest    23a538c107a0   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" minutes ago   673MB\n")])])]),e("blockquote",[e("p",[s._v("启动镜像")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs tomcat"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d -p 8080:8080 --name sail-tomcat -v /home/sail/tomcat/webapps:/usr/local/apache-tomcat-9.0.55/webapps -v /home/sail/tomcat/logs:/usr/local/apache-tomcat-9.0.55/logs tomcat-test ")]),s._v("\n9d391e13efdc495206429dbdb0392180a7bd3a4750cbc1419c31c80cd69c6b7b\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@sail tomcat"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n")])])]),e("p",[s._v("启动时将 tomcat 的 "),e("strong",[s._v("webapps")]),s._v(" 和 "),e("strong",[s._v("logs")]),s._v(" 目录都挂载到了本机。")]),s._v(" "),e("blockquote",[e("p",[s._v("查看挂载目录")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs tomcat"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls /home/sail/tomcat")]),s._v("\nlogs  webapps\n")])])]),e("p",[s._v("这里找到了挂载到本机的两个目录，说明挂载成功了。")]),s._v(" "),e("blockquote",[e("p",[s._v("进入容器")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs tomcat"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps")]),s._v("\nCONTAINER ID   IMAGE         COMMAND                  CREATED          STATUS          PORTS                    NAMES\n9d391e13efdc   tomcat-test   "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"/bin/sh -c '"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CATALI")]),s._v('…"')]),s._v("   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" minutes ago   Up "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" minutes   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:8080-"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("/tcp   sail-tomcat\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@sail tomcat"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it 9d391e13efdc /bin/bash")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@9d391e13efdc local"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\napache-tomcat-9.0.55  bin  etc    games  include    jdk1.8.0_301  lib  lib64  libexec  readme.txt  sbin  share  src\n\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@9d391e13efdc local"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd apache-tomcat-9.0.55/")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@9d391e13efdc apache-tomcat-9.0.55"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nBUILDING.txt  CONTRIBUTING.md  LICENSE    NOTICE    README.md  RELEASE-NOTES  RUNNING.txt  bin  conf  lib  logs  temp  webapps  work\n")])])]),e("p",[s._v("jdk 和 readme.txt 都是具备了的，且 tomcat 目录下的文件也是完整的。")]),s._v(" "),e("blockquote",[e("p",[s._v("查看挂载文件")])]),s._v(" "),e("p",[s._v("这里以 logs 为例，我们先进入 tomcat 容器中的 logs 文件夹查看日志内容。")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@9d391e13efdc apache-tomcat-9.0.55"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd logs")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@9d391e13efdc logs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\ncatalina.out\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@9d391e13efdc logs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat catalina.out ")]),s._v("\n/usr/local//apache-tomcat-9.0.55/bin/catalina.sh: line "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("504")]),s._v(": /usr/local//jdk1.8.0_301-amd64/bin/java: No such "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" or directory\n")])])]),e("p",[s._v("然后再退出查看主机上挂载的 logs 文件夹。")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@9d391e13efdc logs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# exit")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs tomcat"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /home/sail/tomcat/logs")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs logs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\ncatalina.out\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs logs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat catalina.out ")]),s._v("\n/usr/local//apache-tomcat-9.0.55/bin/catalina.sh: line "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("504")]),s._v(": /usr/local//jdk1.8.0_301-amd64/bin/java: No such "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" or directory\n")])])]),e("p",[s._v("两个地方 logs 下的文件内容一致，说明挂载成功。")]),s._v(" "),e("h2",{attrs:{id:"发布镜像到-docker-hub"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#发布镜像到-docker-hub"}},[s._v("#")]),s._v(" 发布镜像到 Docker Hub")]),s._v(" "),e("blockquote",[e("p",[s._v("注册账号")])]),s._v(" "),e("p",[s._v("如果没有 Docker Hub 账号，先注册账号：https://hub.docker.com/")]),s._v(" "),e("blockquote",[e("p",[s._v("登录 Docker Hub 账号")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs logs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker login -u 账号")]),s._v("\nPassword: \nWARNING"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" Your password will be stored unencrypted "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" /root/.docker/config.json.\nConfigure a credential helper to remove this warning. See\nhttps://docs.docker.com/engine/reference/commandline/login/"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#credentials-store")]),s._v("\nLogin Succeeded\n")])])]),e("h3",{attrs:{id:"发布镜像"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#发布镜像"}},[s._v("#")]),s._v(" 发布镜像")]),s._v(" "),e("h4",{attrs:{id:"docker-push"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-push"}},[s._v("#")]),s._v(" docker push")]),s._v(" "),e("blockquote",[e("p",[s._v("直接发布镜像")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs logs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker push centos-test")]),s._v("\nUsing default tag: latest\nThe push refers to repository "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("docker.io/library/centos-test"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nde70c523870b: Preparing \n909db45c4bc4: Preparing \n74ddd0ec08fa: Preparing \ndenied: requested access to the resource is denied\n")])])]),e("p",[s._v("访问资源被拒绝了。拒绝的原因是我们没有带标签，默认的 latest 标签是不能被识别的。")]),s._v(" "),e("h3",{attrs:{id:"指定镜像标签"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#指定镜像标签"}},[s._v("#")]),s._v(" 指定镜像标签")]),s._v(" "),e("h4",{attrs:{id:"docker-tag"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-tag"}},[s._v("#")]),s._v(" docker tag")]),s._v(" "),e("p",[s._v("我们可以使用 "),e("code",[s._v("docker tag")]),s._v(" 命令给镜像加一个标签。")]),s._v(" "),e("blockquote",[e("p",[s._v("必须以 "),e("code",[s._v("账号名/镜像名:标签")]),s._v(" 的格式命令才能提交。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs logs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker tag d58be7785771 账号/centos:1.0")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs logs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images")]),s._v("\nREPOSITORY        TAG       IMAGE ID       CREATED        SIZE\nasailing/centos   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v("       d58be7785771   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("29")]),s._v(" hours ago   323MB\ncentos-test       latest    d58be7785771   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("29")]),s._v(" hours ago   323MB\n")])])]),e("p",[s._v("此时会多出一个相同 ID 但是标签和名字不同的镜像。")]),s._v(" "),e("blockquote",[e("p",[s._v("再次发布镜像")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs logs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker push asailing/centos:1.0")]),s._v("\nThe push refers to repository "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("docker.io/asailing/centos"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nde70c523870b: Pushed \n909db45c4bc4: Pushed \n74ddd0ec08fa: Pushed \n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v(": digest: sha256:ecefaae6c5a2cab84693175ea3b18d0d0a7aa0160e33a0bf3eb4ab626b10f0f1 size: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("953")]),s._v("\n")])])]),e("p",[s._v("这样就能发布成功了。且可以发现，"),e("strong",[s._v("镜像的发布也是分层发布的")]),s._v("。")]),s._v(" "),e("h2",{attrs:{id:"配置国内镜像站"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置国内镜像站"}},[s._v("#")]),s._v(" 配置国内镜像站")]),s._v(" "),e("p",[s._v("由于对国外网络的限制，发布镜像到 DockerHub 是比较缓慢的。")]),s._v(" "),e("p",[s._v("这里可以使用配置 "),e("strong",[s._v("Docker 国内镜像站")]),s._v("的方式实现加速。")]),s._v(" "),e("p",[s._v("运行以下命令即可：")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# curl -sSL https://get.daocloud.io/daotools/set_mirror.sh | sh -s http://f1361db2.m.daocloud.io")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" version "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.12")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"registry-mirrors"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://f1361db2.m.daocloud.io"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nSuccess.\nYou need to restart "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" to take effect: "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl restart docker")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n")])])]),e("p",[s._v("该脚本可以将 "),e("code",[s._v("--registry-mirror")]),s._v(" 加入到 Docker 配置文件 "),e("code",[s._v("/etc/docker/daemon.json")]),s._v(" 中。")]),s._v(" "),e("p",[s._v("适用于 "),e("strong",[s._v("Ubuntu14.04")]),s._v("、"),e("strong",[s._v("Debian")]),s._v("、"),e("strong",[s._v("CentOS6")]),s._v(" 、"),e("strong",[s._v("CentOS7")]),s._v("、"),e("strong",[s._v("Fedora")]),s._v("、"),e("strong",[s._v("Arch Linux")]),s._v("、"),e("strong",[s._v("openSUSE Leap 42.1")]),s._v("，其他版本可能有细微不同。")]),s._v(" "),e("blockquote",[e("p",[s._v("去 Docker Hub 上以 "),e("strong",[s._v("账号名/镜像名")]),s._v(" 搜索我们刚发布的镜像，发现是可以搜索到的。")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(468),alt:"img"}})]),s._v(" "),e("blockquote",[e("p",[s._v("查看详情也可以镜像的具体信息。")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(469),alt:"img"}})]),s._v(" "),e("p",[s._v("DIGEST 的值正是刚才发布后返回值 "),e("code",[s._v("ecefaae6c5a2cab84693175ea3b18d0d0a7aa0160e33a0bf3eb4ab626b10f0f1")]),s._v(" 的缩写。")]),s._v(" "),e("p",[s._v("且镜像的大小是小于我们本地镜像的，说明"),e("strong",[s._v("发布的过程中也会压缩镜像")]),s._v("。")]),s._v(" "),e("blockquote",[e("p",[s._v("拉取我们发布的镜像")])]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("[root@qzs logs]# docker pull 账号/centos:1.0\n1.0: Pulling from asailing/centos\nDigest: sha256:ecefaae6c5a2cab84693175ea3b18d0d0a7aa0160e33a0bf3eb4ab626b10f0f1\nStatus: Image is up to date for asailing/centos:1.0\ndocker.io/asailing/centos:1.0\n")])])]),e("p",[s._v("无法拉取。原因很简单，因为我们本地存在了同名镜像。")]),s._v(" "),e("blockquote",[e("p",[s._v("我们先删除这个镜像再拉取")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs logs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker rmi -f d58be7785771")]),s._v("\nUntagged: asailing/centos:1.0\nUntagged: asailing/centos@sha256:ecefaae6c5a2cab84693175ea3b18d0d0a7aa0160e33a0bf3eb4ab626b10f0f1\nUntagged: centos-test:latest\nUntagged: sail/centos:1.0\nDeleted: sha256:d58be7785771bd95d8016fa5807a486d6c50e195879eddd88cb602172fc51ffe\nDeleted: sha256:ad95558eb65801f5871215837558156c5e33ba351b3b52e0a50aac045abb46c1\nDeleted: sha256:5c5def0bbb85d8779d02f115c3d072fe9adb1fd07556ee8c5a130823ecf6811d\nDeleted: sha256:b5bd21416741daec348f417dbea1b73001e257f1e63a5d2abddabc8554fca611\nDeleted: sha256:a9431f90fd3f23387c456ad5b925dbb9531beece3eab825848db99db29c6a1fa\nDeleted: sha256:9f54f48660acb350921aefab74769e51fc7917a1e1e730d3df2edd1513517c42\nDeleted: sha256:fb41ece5d944c667762945fdf7275a1d267acd92fe9dc56709fc3adaca6f087f\nDeleted: sha256:be89377d4c2ccea11308d8196ba53f03985882db015e01ed8b54fc114f4ba058\nDeleted: sha256:9616888f3b103230ed5f378af4afc11b7ce7ed3d96653e5bd918c49152bbdf8c\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs logs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker pull 账号/centos:1.0")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v(": Pulling from asailing/centos\na1d0c7532777: Already exists \n0594d57f8468: Already exists \n9c13f720f33e: Already exists \nDigest: sha256:ecefaae6c5a2cab84693175ea3b18d0d0a7aa0160e33a0bf3eb4ab626b10f0f1\nStatus: Downloaded newer image "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" asailing/centos:1.0\ndocker.io/asailing/centos:1.0\n\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs logs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images")]),s._v("\nREPOSITORY        TAG       IMAGE ID       CREATED        SIZE\nasailing/centos   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v("       d58be7785771   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("29")]),s._v(" hours ago   323MB\n")])])]),e("p",[s._v("拉取成功，且大小又恢复到了之前本地的镜像大小，说明"),e("strong",[s._v("拉取的过程中也会解压镜像")]),s._v("。")]),s._v(" "),e("blockquote",[e("p",[s._v("启动拉取的镜像")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs logs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -it asailing/centos:1.0 /bin/bash")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@168c9e550886 local"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim test.java")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@168c9e550886 local"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n")])])]),e("p",[e("code",[s._v("vim")]),s._v(" 命令也是可以使用的，镜像发布成功。")]),s._v(" "),e("h2",{attrs:{id:"发布镜像到阿里云镜像仓库"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#发布镜像到阿里云镜像仓库"}},[s._v("#")]),s._v(" 发布镜像到阿里云镜像仓库")]),s._v(" "),e("blockquote",[e("p",[s._v("登录阿里云，点击"),e("strong",[s._v("我的阿里云")])])]),s._v(" "),e("p",[e("img",{attrs:{src:a(470),alt:"img"}})]),s._v(" "),e("p",[e("img",{attrs:{src:a(471),alt:"img"}})]),s._v(" "),e("blockquote",[e("p",[s._v("创建实例")])]),s._v(" "),e("p",[s._v("这里以创建个人版实例为例。")]),s._v(" "),e("p",[s._v("我这里已经创建好了，如果没有创建点击创建即可。")]),s._v(" "),e("p",[e("img",{attrs:{src:a(472),alt:"img"}})]),s._v(" "),e("blockquote",[e("p",[s._v("进入镜像仓库")])]),s._v(" "),e("p",[s._v("创建好个人实例后，点击进入。")]),s._v(" "),e("p",[e("img",{attrs:{src:a(473),alt:"img"}})]),s._v(" "),e("blockquote",[e("p",[s._v("创建命名空间")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(474),alt:"img"}})]),s._v(" "),e("p",[s._v("一个账号只能创建 3 个命名空间，需要谨慎创建。")]),s._v(" "),e("p",[s._v("创建好后就是这样。")]),s._v(" "),e("p",[e("img",{attrs:{src:a(475),alt:"img"}})]),s._v(" "),e("blockquote",[e("p",[s._v("创建镜像仓库")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(476),alt:"img"}})]),s._v(" "),e("blockquote",[e("p",[s._v("点击下一步，创建本地仓库")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(477),alt:"img"}})]),s._v(" "),e("p",[e("img",{attrs:{src:a(478),alt:"img"}})]),s._v(" "),e("p",[s._v("至此，我们就创建好了阿里云的镜像仓库，具体的操作步骤上图也写得非常清楚。")]),s._v(" "),e("blockquote",[e("p",[s._v("退出登录的账号")])]),s._v(" "),e("p",[s._v("如果之前登录了 Docker Hub 账号或者其他阿里云账号，先退出账号。")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs logs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker logout")]),s._v("\nRemoving login credentials "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" https://index.docker.io/v1/\n")])])]),e("blockquote",[e("p",[s._v("登录阿里云账号")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs logs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker login --username=用户名 registry.cn-hangzhou.aliyuncs.com")]),s._v("\nPassword: \nWARNING"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" Your password will be stored unencrypted "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" /root/.docker/config.json.\nConfigure a credential helper to remove this warning. See\nhttps://docs.docker.com/engine/reference/commandline/login/"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#credentials-store")]),s._v("\nLogin Succeeded\n")])])]),e("blockquote",[e("p",[s._v("设置镜像标签")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs logs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker tag d58be7785771 registry.cn-hangzhou.aliyuncs.com/asailing/qzs:1.0")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs logs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images")]),s._v("\nREPOSITORY                                        TAG       IMAGE ID       CREATED        SIZE\nasailing/centos                                   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v("       d58be7785771   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v(" hours ago   323MB\nregistry.cn-hangzhou.aliyuncs.com/asailing/sail   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v("       d58be7785771   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v(" hours ago   323MB\n")])])]),e("blockquote",[e("p",[s._v("提交镜像")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs logs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker push registry.cn-hangzhou.aliyuncs.com/asailing/qzs:1.0")]),s._v("\nThe push refers to repository "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("registry.cn-hangzhou.aliyuncs.com/asailing/qzs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nde70c523870b: Pushed \n909db45c4bc4: Pushed \n74ddd0ec08fa: Pushed \n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v(": digest: sha256:ecefaae6c5a2cab84693175ea3b18d0d0a7aa0160e33a0bf3eb4ab626b10f0f1 size: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("953")]),s._v("\n")])])]),e("blockquote",[e("p",[s._v("查看提交的镜像")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(479),alt:"img"}})]),s._v(" "),e("p",[s._v("提交的镜像可以在这里查看。")]),s._v(" "),e("blockquote",[e("p",[s._v("拉取镜像")])]),s._v(" "),e("p",[s._v("先删除本地镜像， 再拉取测试。")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs logs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker rmi -f d58be7785771")]),s._v("\nUntagged: asailing/centos:1.0\nUntagged: asailing/centos@sha256:ecefaae6c5a2cab84693175ea3b18d0d0a7aa0160e33a0bf3eb4ab626b10f0f1\nUntagged: registry.cn-hangzhou.aliyuncs.com/asailing/sail/centos:1.0\nUntagged: registry.cn-hangzhou.aliyuncs.com/asailing/sail:1.0\nUntagged: registry.cn-hangzhou.aliyuncs.com/asailing/sail@sha256:ecefaae6c5a2cab84693175ea3b18d0d0a7aa0160e33a0bf3eb4ab626b10f0f1\nDeleted: sha256:d58be7785771bd95d8016fa5807a486d6c50e195879eddd88cb602172fc51ffe\n\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs logs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker pull registry.cn-hangzhou.aliyuncs.com/asailing/sail:1.0")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v(": Pulling from asailing/sail\na1d0c7532777: Already exists \n0594d57f8468: Already exists \n9c13f720f33e: Already exists \nDigest: sha256:ecefaae6c5a2cab84693175ea3b18d0d0a7aa0160e33a0bf3eb4ab626b10f0f1\nStatus: Downloaded newer image "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" registry.cn-hangzhou.aliyuncs.com/asailing/sail:1.0\nregistry.cn-hangzhou.aliyuncs.com/asailing/sail:1.0\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs logs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images")]),s._v("\nREPOSITORY                                        TAG       IMAGE ID       CREATED        SIZE\nregistry.cn-hangzhou.aliyuncs.com/asailing/sail   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v("       d58be7785771   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v(" hours ago   323MB\n")])])]),e("blockquote",[e("p",[s._v("启动镜像")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs logs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -it registry.cn-hangzhou.aliyuncs.com/asailing/sail:1.0")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@c612099a94a2 local"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim test.java")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@c612099a94a2 local"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n")])])]),e("p",[e("code",[s._v("vim")]),s._v(" 命令可以使用，说明提交镜像成功。")]),s._v(" "),e("h1",{attrs:{id:"docker网络"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker网络"}},[s._v("#")]),s._v(" Docker网络")]),s._v(" "),e("h2",{attrs:{id:"理解docker0"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#理解docker0"}},[s._v("#")]),s._v(" 理解Docker0")]),s._v(" "),e("p",[e("img",{attrs:{src:a(480),alt:"image-20220630164754130"}})]),s._v(" "),e("blockquote",[e("p",[s._v("docker是如何处理容器访问网络的？")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1.启动一个tomcat容器")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d -P --name tomcat01 tomcat\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2.查看容器的内部网络地址")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#第一种docker exec -it tomact ip addr")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#第二种 先进入容器 在使用ip addr")]),s._v("\nroot@8c32956f7370:/usr/local/tomcat"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ip addr")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(": lo: "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("LOOPBACK,UP,LOWER_UP"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mtu "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("65536")]),s._v(" qdisc noqueue state UNKNOWN group default qlen "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1/8 scope "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" lo\n       valid_lft forever preferred_lft forever\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("36")]),s._v(": eth0@if37: "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("BROADCAST,MULTICAST,UP,LOWER_UP"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mtu "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1500")]),s._v(" qdisc noqueue state UP group default\n    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    inet "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.2/16 brd "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".255.255 scope global eth0\n       valid_lft forever preferred_lft forever\n       \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#3. ping 容器ip")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@qzs /"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ping 172.17.0.2")]),s._v("\nPING "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.2 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("56")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("84")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" bytes of data.\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" bytes from "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.2: "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("icmp_seq")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ttl")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("time")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.986")]),s._v(" ms\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" bytes from "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.2: "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("icmp_seq")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ttl")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("time")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.102")]),s._v(" ms\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" bytes from "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.2: "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("icmp_seq")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ttl")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("time")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.070")]),s._v(" ms\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" bytes from "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.2: "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("icmp_seq")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ttl")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("time")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.062")]),s._v(" ms\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" bytes from "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.2: "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("icmp_seq")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ttl")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("time")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.076")]),s._v(" ms\n--- "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.2 "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" statistics ---\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" packets transmitted, "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" received, "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% packet loss, "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v(" 4001ms\nrtt min/avg/max/mdev "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.062")]),s._v("/0.259/0.986/0.363 ms\n \n")])])]),e("blockquote",[e("p",[s._v("原理")])]),s._v(" "),e("p",[s._v("1.每启动一个docker容器，docker就会给docker容器分配一个ip，我们只要安装了docker，就会有一个网卡docker0")]),s._v(" "),e("p",[s._v("docker0是桥接模式，使用的技术是evth-pair技术")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#容器带来网卡，都是一对对的")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#evth-pair 就是一对的虚拟设备接口，它们都是成对出现的，一段连着协议，一段彼此相连")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#正因为有这个特性，evth-pair充当一个桥梁，连接各种虚拟网络设备的")]),s._v("\n")])])]),e("p",[s._v("容器与容器之间可以相互ping通的")]),s._v(" "),e("p",[e("img",{attrs:{src:a(481),alt:""}})]),s._v(" "),e("p",[s._v("​\t结论：tomcat01 与 tomcat02是公用的一个路由器 docker0")]),s._v(" "),e("p",[s._v("所有的容器不指定网络的情况下，都是docker0路由，docker会给我们容器分配一个默认的可用IP")]),s._v(" "),e("blockquote",[e("p",[s._v("小结")])]),s._v(" "),e("p",[s._v("Docker使用的是Linux的桥接")]),s._v(" "),e("p",[e("img",{attrs:{src:a(482),alt:""}})]),s._v(" "),e("p",[s._v("Docker中的所有网络接口都是虚拟的，虚拟的转发效率高、")]),s._v(" "),e("p",[s._v("只要容器删除，对应的网桥就没了")]),s._v(" "),e("h2",{attrs:{id:"link"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#link"}},[s._v("#")]),s._v(" --link")]),s._v(" "),e("blockquote",[e("p",[s._v("场景问题: 每次重新启动一个容器 容器ip变化，那么使用ip去访问就十分麻烦，有没有可以提供访问服务名来访问容器这样不管ip怎么变只要服务名不变就可以正常访问该容器")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. 通过服务名ping不通；如何解决？")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it tomcat02 "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" tomcat01\nping: tomcat01: Name or "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" not known\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2.通过--link可以解决网络连接问题。")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d -P --name tomcat02 --link tomcat01 tomcat:7.0\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it tomcat03 "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" tomcat02\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#3.反向可以ping通吗？（不可以）")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it tomcat02 "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" tomcat03\nping: tomcat03: Name or "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" not known\n\n")])])]),e("p",[s._v("探究：docker network inspect networkID (docker network ls可以查看networkID)")]),s._v(" "),e("p",[s._v("其实这个tomcat03就是在本地配置了tomcat02的配置")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1.查看")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it tomcat03 "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/hosts\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1       localhost\n::1     localhost ip6-localhost ip6-loopback\nfe00::0 ip6-localnet\nff00::0 ip6-mcastprefix\nff02::1 ip6-allnodes\nff02::2 ip6-allrouters\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.3      tomcat02 20398a94efa7\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.4      2393eecb870e\n")])])]),e("p",[s._v("本质探究：—link 就是我们在hosts配置中增加了一个”172.17.0.3 tomcat02 20398a94efa7”\n我们现在玩Docker已经不建议使用—link了！\n自定义网络！不适用docker0！\ndocker0问题：他不支持容器名连接访问！")]),s._v(" "),e("h2",{attrs:{id:"自定义网络"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#自定义网络"}},[s._v("#")]),s._v(" 自定义网络")]),s._v(" "),e("blockquote",[e("h3",{attrs:{id:"查看所有的docker网络"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看所有的docker网络"}},[s._v("#")]),s._v(" 查看所有的docker网络")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n")])])]),e("blockquote",[e("p",[e("strong",[s._v("网络模式")])])]),s._v(" "),e("p",[s._v("bridge：桥接 docker（默认，自己创建也使用bridge桥接模式）\nnone：不配置网络\nhost：和主机共享网络\ncontainer：容器网络连通！（用的少！局限很大）")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 我们直接启动的命令--net bridge（这个就是我们的docker0）；默认带上这个参数的，以下两种启动方式效果一致。")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d -P --name tomcat01 tomcat\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d -P --name tomcato1 --het bridge tomcat\n")])])]),e("blockquote",[e("p",[s._v("创建自定义网络")])]),s._v(" "),e("ul",[e("li",[s._v("docker network creat\n"),e("ul",[e("li",[e("code",[s._v("-d")]),s._v("：网络模式")]),s._v(" "),e("li",[e("code",[s._v("--subnet")]),s._v("：子网")]),s._v(" "),e("li",[e("code",[s._v("--gateway")]),s._v("：网关")])])])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker0特点：默认，域名不能访问，--1ink可以打通连接！")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 我们可以自定义一个网络！")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker network")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network create --driver bridge --subnet "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.0/16 --gateway "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.1 mynet\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看创建的网络")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\nNETWORK ID     NAME      DRIVER    SCOPE\n7254ffccbdf5   bridge    bridge    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n45610891738f   "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("      "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("      "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n266acd66473c   mynet     bridge    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n7795cbc2686c   none      null      "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n")])])]),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network inspect 801fbbe1b38c\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mynet"')]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Id"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"801fbbe1b38c81b12ce90aa9139561b5843dca64b4b17718b6e2622369f9be67"')]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Created"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2021-12-30T17:39:43.100705632+08:00"')]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Scope"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local"')]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Driver"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bridge"')]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"EnableIPv6"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IPAM"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Driver"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"default"')]),s._v(",\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Options"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Config"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Subnet"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.0.0/16"')]),s._v(",\n                    "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Gateway"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.0.1"')]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Internal"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Attachable"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Ingress"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ConfigFrom"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Network"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ConfigOnly"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Containers"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Options"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Labels"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n\n\n")])])]),e("blockquote",[e("p",[s._v("以下配置可以看出，自定义网络创建完成。")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Config"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Subnet"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.0.0/16"')]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Gateway"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.0.1"')]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),e("p",[s._v("启动容器")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动两个容器测试：")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d -P --name tomcat-net-01 --net mynet tomcat:7.0\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d -P --name tomcat-net-02 --net mynet tomcat:7.0\n")])])]),e("p",[s._v("连接测试")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不使用--link，ping名字也可以ping通。tomcat-net-01 ping tomcat-net-02可以ping通")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it tomcat-net-01 "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" tomcat-net-02\nPING tomcat-net-02 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.3"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("56")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("84")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" bytes of data.\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" bytes from tomcat-net-02.mynet "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.3"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("icmp_seq")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ttl")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("time")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.067")]),s._v(" ms\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" bytes from tomcat-net-02.mynet "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.3"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("icmp_seq")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ttl")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("time")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.056")]),s._v(" ms\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不使用--link，ping名字也可以ping通。tomcat-net-02 ping tomcat-net-01可以ping通")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it tomcat-net-02 "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" tomcat-net-01\nPING tomcat-net-01 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("56")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("84")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" bytes of data.\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" bytes from tomcat-net-01.mynet "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("icmp_seq")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ttl")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("time")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.050")]),s._v(" ms\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" bytes from tomcat-net-01.mynet "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("icmp_seq")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ttl")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("time")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.056")]),s._v(" ms\n")])])]),e("p",[s._v("能够连通说明不同容器处于同一网络下。")]),s._v(" "),e("blockquote",[e("p",[s._v("这种方式可以实现不同集群使用不同的网络，保证集群网络的安全。")])]),s._v(" "),e("p",[s._v("我们自定义的网络docker都已经帮我们维护好了对应的关系，"),e("strong",[s._v("推荐我们平时这样使用网络")]),s._v("！\nredis -不同的集群使用不同的网络，保证集群是安全和健康的\nmysql -不同的集群使用不同的网络，保证集群是安全和健康的")]),s._v(" "),e("h2",{attrs:{id:"网络连通"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#网络连通"}},[s._v("#")]),s._v(" 网络连通")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tomcat01在docker0网络下，tomcat-net-01在mynet网络下；")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tomcat01 ping tomcat-net-01是ping不通的")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it tomcat01 "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" tomcat-net-01\nping: tomcat-net-01: Name or "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" not known\n")])])]),e("p",[e("img",{attrs:{src:a(483),alt:""}})]),s._v(" "),e("div",{staticClass:"language-powershell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-powershell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1.查看docker 网络")]),s._v("\ndocker network "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("help\nUsage:  docker network COMMAND\nManage networks\nCommands:\n  connect     Connect a container to a network\n  create      Create a network\n  disconnect  Disconnect a container "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" a network\n  inspect     Display detailed information on one or more networks\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("          List networks\n  prune       Remove all unused networks\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v("          Remove one or more networks\nRun "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'docker network COMMAND --help'")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" more information on a command"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n\n")])])]),e("p",[s._v("使用"),e("code",[s._v("docker network connect")]),s._v("实现一个容器链接到另一个网段。")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1.建立连接")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network connect mynet tomcat02-net\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2.查看docker网络")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\nNETWORK ID     NAME      DRIVER    SCOPE\nf3eeb014197a   bridge    bridge    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n28d77e958643   "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("      "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("      "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n801fbbe1b38c   mynet     bridge    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\nc3ff850e96f0   none      null      "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#3.查看 容器所在网络的网络配置")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network inspect 801fbbe1b38c\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mynet"')]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Id"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"801fbbe1b38c81b12ce90aa9139561b5843dca64b4b17718b6e2622369f9be67"')]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Created"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2021-12-30T17:39:43.100705632+08:00"')]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Scope"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local"')]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Driver"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bridge"')]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"EnableIPv6"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IPAM"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Driver"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"default"')]),s._v(",\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Options"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Config"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Subnet"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.0.0/16"')]),s._v(",\n                    "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Gateway"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.0.1"')]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Internal"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Attachable"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Ingress"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ConfigFrom"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Network"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ConfigOnly"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Containers"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5a02cd4172daccc5073907ee6b063560687db5ffdd5041b18fd3ff1055a8984c"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tomcat02-net"')]),s._v(",\n                "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"EndpointID"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"e6503138bcb91a7693576e324df75d1dff594f1c5aa3e08397802c38133eb0e9"')]),s._v(",\n                "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MacAddress"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"02:42:c0:a8:00:05"')]),s._v(",\n                "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IPv4Address"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.0.5/16"')]),s._v(",\n                "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IPv6Address"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Options"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Labels"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),e("p",[s._v("这样也可以实现容器链接到自定义网络。")]),s._v(" "),e("blockquote",[e("p",[s._v("查看容器详情")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1.查看运行中的容器id")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\nCONTAINER ID   IMAGE     COMMAND             CREATED             STATUS             PORTS                     NAMES\n5a02cd4172da   tomcat    "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"catalina.sh run"')]),s._v("   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" minutes ago       Up "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" minutes       "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:49159-"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("/tcp   tomcat02-net\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2.查看容器的网络配置")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" inspect 5a02cd4172da\n")])])]),e("p",[e("img",{attrs:{src:a(484),alt:""}})]),s._v(" "),e("blockquote",[e("p",[s._v("测试连接")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it tomcat02 "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" tomcat02-net\nPING tomcat02-net "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("56")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("84")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" bytes of data.\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" bytes from tomcat02-net.mynet "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("icmp_seq")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ttl")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("time")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.121")]),s._v(" ms\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" bytes from tomcat02-net.mynet "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("icmp_seq")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ttl")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("time")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.064")]),s._v(" ms\n^C\n--- tomcat02-net "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" statistics ---\n")])])]),e("p",[s._v("网络连通成功。")])])}),[],!1,null,null,null);t.default=n.exports}}]);